!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.avalon=b()}(this,function(){"use strict";function h(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}function k(a,b){return j[a]&&n.warn(a,"directive have defined! "),j[a]=b,b.update||(b.update=function(){}),b.delay&&(i[a]=1),b}function l(a){for(var b in i)if("ms-"+b in a)return!0}function n(a){return new n.init(a)}function o(a,b){for(var c in b)a[c]=b[c];return a}function s(a,b){var c,d,e,f;for("string"==typeof a&&(a=a.match(p)||[]),c={},d=void 0!==b?b:1,e=0,f=a.length;f>e;e++)c[a[e]]=d;return c}function u(a){return n._quote(a)}function z(){y&&n.config.debug&&Function.apply.call(console.log,console,arguments)}function A(){if(y&&n.config.debug){var a=console.warn||console.log;Function.apply.call(a,console,arguments)}}function B(a,b){throw(b||Error)(a)}function C(){}function D(a){return null!==a&&"object"==typeof a}function E(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f}function G(a){return a.replace(F,"$1-$2").toLowerCase()}function I(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(H,function(a){return a.charAt(1).toUpperCase()})}function K(a,b,c){return J.call(a,b,c)}function M(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(L,a)}function N(a){return a.uuid||(a.uuid=M("e"))}function P(a){return a.uuid||(a.uuid="_"+ ++O)}function R(a){return(a+"").replace(Q,"\\$&")}function W(){return c.createDocumentFragment()}function Z(a){var b,c;for(b in a)c=a[b],"function"==typeof Z.plugins[b]?Z.plugins[b](c):Z[b]=c;return this}function _(a){return c.createComment(a)}function ab(a){return/\[native code\]/.test(a)}function hb(a,b,c){var d="for(var "+a+"i=0,n = this.length; i < n; i++){"+b.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+c;return Function("fn,scope",d)}function lb(a){return a?a==a.document&&a.document!=a:!1}function nb(a){return mb.test(v.call(a))}function qb(a,b){if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!w.call(a,"constructor")&&!w.call(a.constructor.prototype,"isPrototypeOf"))return!1;a.$vbthis}catch(d){return!1}if(pb)for(b in a)return w.call(a,b);for(b in a);return b===tb||w.call(a,b)}function rb(a){return"[object Object]"===v.call(a)&&Object.getPrototypeOf(a)===Object.prototype}function ub(a,b){var d,e,f,g,h,i,j,k,l,c=b[0];for(g=1,h=b.length;h>g;g++){i=b[g],j=Array.isArray(i);for(f in i)if(!j||i.hasOwnProperty(f)){try{k=c[f],l=i[f]}catch(m){continue}c!==l&&(a&&l&&(n.isPlainObject(l)||(d=Array.isArray(l)))?(d?(d=!1,e=k&&Array.isArray(k)?k:[]):e=k&&n.isPlainObject(k)?k:{},c[f]=ub(a,[e,l])):l!==tb&&(c[f]=l))}}return c}function wb(a){var b,c;if(!a)return!1;if(b=a.length,b===b>>>0){if(c=v.call(a),vb.test(c))return!0;if("[object Object]"!==c)return!1;try{return{}.propertyIsEnumerable.call(a,"length")===!1?kb.test(a.item||a.callee):!0}catch(d){return!a.window}}return!1}function xb(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)}function yb(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g="string"==typeof d?d:",",h=c||".",i="";return i=(f?xb(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),i.join(h)}function Db(a){return a.replace(zb,"").replace(Bb,function(a){var d,c=a.toLowerCase().match(/<(\w+)\s/);return c&&(d=Cb[c[1]],d&&(a=a.replace(d,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))),a.replace(Ab," ").replace(/\s+/g," ")})}function Eb(a){return parseInt(a,10)||0}function Fb(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function Gb(a,b,c,d){return function(e){var f=e["get"+a]();return(c>0||f>-c)&&(f+=c),0===f&&-12===c&&(f=12),Fb(f,b,d)}}function Hb(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function Ib(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=Fb(Math[b>0?"floor":"ceil"](b/60),2)+Fb(Math.abs(b%60),2)}function Jb(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function Nb(a,b){var f,g,h,i,j,k,l,m,n,c=Nb.locate,d="",e=[];for(b=b||"mediumDate",b=c[b]||b,"string"==typeof a&&(/^\d+$/.test(a)?a=Eb(a):Mb.test(a)?a=+RegExp.$1:(h=a.trim(),i=[0,0,0,0,0,0,0],j=new Date(0),h=h.replace(/^(\d+)\D(\d+)\D(\d+)/,function(a,b,c,d){var e=4===d.length?[d,b,c]:[b,c,d];return i[0]=Eb(e[0]),i[1]=Eb(e[1])-1,i[2]=Eb(e[2]),""}),k=j.setFullYear,l=j.setHours,h=h.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(a,b,c,d,e){return i[3]=Eb(b),i[4]=Eb(c),i[5]=Eb(d),e&&(i[6]=Math.round(1e3*parseFloat("0."+e))),""}),m=0,n=0,h=h.replace(/Z|([+-])(\d\d):?(\d\d)/,function(a,b,c,d){return k=j.setUTCFullYear,l=j.setUTCHours,b&&(m=Eb(b+c),n=Eb(b+d)),""}),i[3]-=m,i[4]-=n,k.apply(j,i.slice(0,3)),l.apply(j,i.slice(3)),a=j)),"number"==typeof a&&(a=new Date(a));b;)g=Lb.exec(b),g?(e=e.concat(g.slice(1)),b=e.pop()):(e.push(b),b=null);return e.forEach(function(b){f=Kb[b],d+=f?f(a,c):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function Rb(a,b,c){var e,f,g,h,i,d=n.type(a);if("array"!==d&&"object"!==d)throw"orderBy只能处理对象或数组";return e="string"==typeof b?function(a){return a&&a[b]}:"function"==typeof b?b:function(a){return a},f={},g=[],Sb(a,Array.isArray(a),function(b){var c=a[b],d=e(c,b);d in f?f[d].push(b):f[d]=[b],g.push(d)}),g.sort(),0>c&&g.reverse(),h="array"===d,i=h?[]:{},Wb(i,g,function(b){var c=f[b].shift();h?i.push(a[c]):i[c]=a[c]})}function Sb(a,b,c){if(b)a.forEach(function(a,b){c(b)});else if("string"==typeof a.$track)a.$track.replace(/[^☥]+/g,function(a){c(a)});else for(var d in a)a.hasOwnProperty(d)&&c(d)}function Tb(a,b){var d,e,f,g,h,i,c=n.type(a);if("array"!==c&&"object"!==c)throw"filterBy只能处理对象或数组";if(d=n.slice(arguments,2),e=n.type(b),"function"===e)f=b._orig||b;else{if("string"!==e&&"number"!==e)return a;if(""===b)return a;g=new RegExp(n.escapeRegExp(b),"i"),f=function(a){return g.test(a)}}return h="array"===c,i=h?[]:{},Sb(a,h,function(b){var c=a[b];f.apply({key:b},[c,b].concat(d))&&(h?i.push(c):i[b]=c)}),i}function Ub(a,b,c){if(n.isObject(a)&&!Array.isArray(a)){var d=[];return Wb(d,b,function(b){d.push(a.hasOwnProperty(b)?a[b]:c?c[b]:"")})}return a}function Vb(a,b,c){var e,f,g,h,i,d=n.type(a);if("array"!==d&&"object"!==d)throw"limitBy只能处理对象或数组";if("number"!=typeof b)return a;if(b!==b)return a;for("object"===d&&(a=Xb(a,!1)),e=a.length,b=Math.floor(Math.min(e,b)),c="number"==typeof c?c:0,0>c&&(c=Math.max(0,e+c)),f=[],g=c;e>g&&f.length!==b;g++)f.push(a[g]);return(h="array"===d)?f:(i={},Wb(i,f,function(a){i[a.key]=a.value}))}function Wb(a,b,c){for(var d=0,e=b.length;e>d;d++)c(b[d]);return a}function Xb(a,b){var c=[],d=0;return Sb(a,b,function(b){c[d]={oldIndex:d,value:a[b],key:b},d++}),c}function _b(a){return null==a?"":String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function cc(a,b){var c,d,f,e;if(1===a.nodeType)if(c=a.nodeName.toLowerCase(),"script"===c)a.text!==b.text&&(a.type="noexec",a.text=b.text,a.type=b.type||"");else if("object"===c){if(d=b.childNodes,a.childNodes.length!==d.length)for(n.clearHTML(a),e=0;f=d[e++];)a.appendChild(f.cloneNode(!0))}else"input"===c&&bc.test(b.nodeName)?(a.defaultChecked=a.checked=b.checked,a.value!==b.value&&(a.value=b.value)):"option"===c?a.defaultSelected=a.selected=b.defaultSelected:("input"===c||"textarea"===c)&&(a.defaultValue=b.defaultValue)}function dc(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function ec(a){var e,b=a.cloneNode(!0),c=dc(b),d=dc(a);for(e=0;e<d.length;e++)cc(c[e],d[e]);return b}function fc(a,b){try{for(;b=b.parentNode;)if(b===a)return!0}catch(c){}return!1}function gc(){function a(a,b){a in d||!HTMLElement.prototype.__defineGetter__||HTMLElement.prototype.__defineGetter__(a,b)}10>f&&(n.cloneNode=ec),c.contains||(c.contains=function(a){return fc(c,a)}),n.modern&&(c.createTextNode("x").contains||(Node.prototype.contains=function(a){return fc(this,a)})),a("outerHTML",function(){var a=c.createElement("div");return a.appendChild(this),a.innerHTML}),a("children",function(){var c,b,a=[];for(b=0;c=this.childNodes[b++];)1===c.nodeType&&a.push(c);return a}),a("innerText",function(){return this.textContent})}function hc(a){this.node=a}function ic(a){return"classList"in a||(a.classList=new hc(a)),a.classList}function mc(a){var b=a.nodeName;return b.toLowerCase()===b&&!!a.scopeName&&""===a.outerText}function rc(a){if("string"==typeof a){if(a=a.trim(),a&&nc.test(a.replace(pc,"@").replace(qc,"]").replace(oc,"")))return new Function("return "+a)();throw TypeError("Invalid JSON: ["+a+"]")}return a}function uc(a,b){var c,d,e,f;for(c in b)try{if(d=b[c],0===c.indexOf("data-")||sc.test(a))a.setAttribute(c,d);else{if(e=jc[c]||c,"boolean"==typeof a[e]&&("checked"===e&&(a.defaultChecked=!!d),a[e]=!!d),d===!1){a.removeAttribute(e);continue}if(n.msie<8&&/[A-Z]/.test(e)){a[e]=d+"";continue}f=!n.modern&&mc(a)?!0:wc(a.nodeName,c),f?(("href"===c||"src"===c)&&n.msie<8&&(d=String(d).replace(tc,"&")),a[e]=d+""):a.setAttribute(c,d)}}catch(g){n.log(String(g.message).trim(),c,d)}}function wc(a,b){var d=a+":"+b;return d in vc?vc[d]:vc[d]=b in c.createElement(a)}function Bc(a,b){var c,d,e;if(a.offsetWidth<=0){if(Ac.test(V["@:get"](a,"display"))){c={node:a};for(d in zc)c[d]=a.style[d],a.style[d]=zc[d];b.push(c)}e=a.parentNode,e&&1===e.nodeType&&Bc(e,b)}}function Cc(a){return a.window||a.defaultView||a.parentWindow||!1}function Kc(a){var b=a.tagName.toLowerCase();return"input"===b?bc.test(a.type)?"checked":a.type:b}function Lc(a){if(a.hasAttribute&&a.hasAttribute("value"))return a.getAttribute("value");var b=a.getAttributeNode("value");return b&&b.specified?b.value:a.innerHTML.trim()}function Oc(a){return s(a+",template,#document-fragment,#comment")}function Wc(a){return Yc(a)}function Yc(a){var d,b=a,c=Xc.get(b);return c?n.mix(!0,[],c):(d=Zc(a,!1),Xc.put(b,n.mix(!0,[],d)),d)}function Zc(a,b){b=void 0===b||b===!0;var c=$c(a,b);return b?"string"==typeof c[0]?c[1]:c[0]:c}function $c(a,b){function i(a){var b=e.last();b&&b.children?b.children.push(a):h.push(a)}var h,j,k,l,m,n,o,p,q,r,s,t,u,d=9990,e=[],f=a,g=a.length;e.last=function(){return e[e.length-1]},h=[];do{if(0===--d)break;if(k=dd(a)){if(a=a.replace(k[0],""),l=e.pop(),!l)throw"是不是有属性值没有用引号括起";if("option"===l.nodeName?l.children=[{nodeName:"#text",nodeValue:gd(l)}]:"table"===l.nodeName&&cd(l.children),j=null,b&&1===h.length&&!e.length)return[f.slice(0,g-a.length),h[0]]}else if(k=fd(a)){if(a=a.replace(k[0],""),m=k[1],i(m),n=!(!m.isVoidTag&&!Sc[m.nodeName]),n||e.push(m),b&&n&&!e.length)return[f.slice(0,g-a.length),m];j=m}else{o="";do{if(p=a.indexOf("<"),0!==p)break;o+=a.slice(0,1),a=a.slice(1)}while(a.length);q=a.indexOf("<"),-1===q?(o=a,a=""):(r=a.indexOf(Z.openTag),-1!==r&&q>r?(0!==r&&(o+=a.slice(0,r)),s=a.slice(r),t=ad(s),o+=t,a=s.slice(t.length)):(o+=a.slice(0,q),a=a.slice(q))),u=_c(j,o,i),u&&(j=u)}}while(a.length);return h}function _c(a,b,c){return Uc.test(b)?a&&"#text"===a.nodeName?(a.nodeValue+=b,a):(a={nodeName:"#text",nodeValue:b},c(a),a):void 0}function ad(a){var g,h,i,j,k,b=Z.closeTag,c=Z.openTag,d=b.charAt(0),e=b.length,f="code";for(i=c.length,j=a.length;j>i;i++)switch(k=a.charAt(i),f){case"code":if('"'===k||"'"===k)f="string",g=k;else if(k===d&&a.substr(i,e)===b)return a.slice(0,i+e);break;case"string":"\\"===k&&/"'/.test(a.charAt(i+1))&&(h=!h),k!==g||h||(f="code")}throw"找不到界定符"+b}function cd(a){var c,d,e,b=!1;for(c=0,d=a.length;d>c;c++)e=a[c],bd.test(e.nodeName)?b=!1:"tr"===e.nodeName?b?(a.splice(c,1),b.children.push(e),d--,c--):(b={nodeName:"tbody",props:{},children:[e]},a.splice(c,1,b)):b&&(a.splice(c,1),b.children.push(e),d--,c--)}function dd(a){var b,c;return 0===a.indexOf("</")&&(b=a.match(/\<\/(\w+[^\s\/\>]*)>/))?(c=b[1],a=a.slice(3+c.length),[b[0],{nodeName:c}]):null}function fd(a){var b,c,d,e,f,g,h,j,k,l;if(0===a.indexOf("<")){if(b=a.indexOf("<!--"),0===b)return c=a.indexOf("-->"),-1===c&&thow("注释节点没有闭合 "+a.slice(0,100)),d={nodeName:"#comment",nodeValue:a.slice(4,c)},[a.slice(0,c+3),d];if(e=a.match(ed)){f=e[0],g=e[1],d={nodeName:g,props:{},children:[]},a=a.replace(f,"");try{h=hd(a)}catch(i){}return h&&(d.props=h[1],a=a.replace(h[0],""),f+=h[0]),">"===a.charAt(0)?(f+=">",a=a.slice(1),Nc[d.nodeName]&&(d.isVoidTag=!0)):"/>"===a.slice(0,2)&&(f+="/>",a=a.slice(2),d.isVoidTag=!0),!d.isVoidTag&&Sc[g]&&(j="</"+g+">",k=a.indexOf(j),l=a.slice(0,k),f+=l+j,d.children.push({nodeName:"#text",nodeValue:l}),"textarea"===g&&(d.props.type=g,d.props.value=l)),[f,d]}}}function gd(a){var b="";return a.children.forEach(function(a){"#text"===a.nodeName?b+=a.nodeValue:a.children&&!Tc[a.nodeName]&&(b+=gd(a))}),b}function hd(a){var e,f,h,i,j,b="AttrName",c="",d="",g={};for(h=0,i=a.length;i>h;h++)switch(j=a.charAt(h),b){case"AttrName":if("/"===j&&">"===a.charAt(h+1)||">"===j)return c&&(g[c]=c),[a.slice(0,h),g];if(Vc.test(j))c&&(b="AttrEqual");else if("="===j){if(!c)throw"必须指定属性名";b="AttrQuote"}else c+=j;break;case"AttrEqual":"="===j?b="AttrQuote":Uc.test(j)&&(g[c]=c,c=j,b="AttrName");break;case"AttrQuote":('"'===j||"'"===j)&&(e=j,b="AttrValue",f=!1);break;case"AttrValue":if("\\"===j&&/"'/.test(a.charAt(h+1))&&(f=!f),"\n"===j)break;j!==e?d+=j:j!==e||f||(g[c]=d,c=d="",b="AttrName")}throw"必须关闭标签"}function nd(a,b){a.setAttribute("avalon-events",b)}function pd(a,b,c){var e,f,g,d=a.getAttribute("avalon-events");!d||a.disabled===!0&&"click"===b||(e=[],f=od[b]||(od[b]=new RegExp("\\b"+b+"\\:([^,\\s]+)","g")),d.replace(f,function(a,b){return e.push(b),a}),e.length&&c.push({elem:a,uuids:e})),a=a.parentNode,g=n.gestureEvents||{},a&&a.getAttribute&&(ld[b]||g[b])&&pd(a,b,c)}function rd(a){var b,c,d,f,g,h,e,j,k,l;for(a=new vd(a),b=a.type,c=a.target,d=[],pd(c,b,d),e=0;(h=d[e++])&&!a.cancelBubble;)for(a.currentTarget=h.elem,f=0;(g=h.uuids[f++])&&!a.stopImmediate;)if(j=n.eventListeners[g]){if(k=qd.test(g)?h.elem._ms_context_:0,k&&k.$hashcode===!1)return n.unbind(c,b,j);l=j.call(k||c,a),l===!1&&(a.preventDefault(),a.stopPropagation())}}function td(a){var c,b=d.getAttribute("delegate-events")||"";-1===b.indexOf(a)&&(c=b.match(n.rword)||[],c.push(a),d.setAttribute("delegate-events",c.join(",")),n._nativeBind(d,a,rd,!!sd[a]))}function vd(a){if(a.originalEvent)return a;for(var b in a)ud[b]||(this[b]=a[b]);this.target||(this.target=a.srcElement),this.target,this.fixEvent(),this.timeStamp=new Date-0,this.originalEvent=a}function Ad(a){for(n.isReady=!0;a=zd.shift();)a(n)}function Bd(){function a(){try{d.doScroll("left"),Ad()}catch(b){setTimeout(a)}}if("complete"===c.readyState)setTimeout(Ad);else if(c.addEventListener)c.addEventListener("DOMContentLoaded",Ad,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",function(){"complete"===c.readyState&&Ad()});try{var b=null===m.frameElement}catch(e){}d.doScroll&&b&&m.external&&a()}n.bind(m,"load",Ad)}function Dd(a,b,c){switch(b){case"style":case"script":case"noscript":case"template":case"xmp":a.children=[{nodeName:"#text",nodeValue:c}];break;case"textarea":var d=a.props;d.type=b,d.value=c,a.children=[{nodeName:"#text",nodeValue:c}];break;case"option":a.children=[{nodeName:"#text",nodeValue:Fd(c)}]}}function Fd(a){return String(a).replace(Ed,"").trim()}function Gd(a){return[Hd(a)]}function Hd(a){var c,d,f,e,g,b=a.nodeName.toLowerCase();switch(b){case"#text":case"#comment":return{nodeName:b,dom:a,nodeValue:a.nodeValue};default:if(c=Jd(a,a.attributes||[]),d={nodeName:b,dom:a,isVoidTag:!!Nc[b],props:c},"option"===b&&(c.selected=a.selected),Cd[b]||"option"===b)Dd(d,b,a.text||a.innerHTML),1===a.childNodes.length&&(d.children[0].dom=a.firstChild);else if(!d.isVoidTag)for(d.children=[],e=0;f=a.childNodes[e++];)g=Hd(f),/\S/.test(g.nodeValue)&&d.children.push(g);return d}}function Jd(a,b){var d,e,f,g,h,c={};for(d=0,e=b.length;e>d;d++)f=b[d],f.specified&&(c[f.name.toLowerCase()]=f.value);return Id.test(a.nodeName)&&(c.type=a.type,g=a.getAttributeNode("value"),g&&/\S/.test(g.value)&&(c.value=g.value)),h=a.style.cssText,h&&(c.style=h),"select-one"===c.type&&(c.selectedIndex=a.selectedIndex),c}function Kd(a){this.nodeName="#text",this.nodeValue=a}function Ld(a){this.nodeName="#comment",this.nodeValue=a}function Md(a,b,c,d){this.nodeName=a,this.props=b,this.children=c,this.isVoidTag=d}function Nd(a,b,c){switch(b){case"style":a.setAttribute("type","text/css"),a.styleSheet.cssText=c;break;case"xmp":case"noscript":a.textContent=c}}function Od(a){return a!==!1&&Object(a)!==a}function Qd(a){return c.createElementNS("http://www.w3.org/2000/svg",a)}function Td(a){var b,d,e;return c.styleSheets.length<31?c.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):c.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)"),b=a.split(":"),1===b.length&&b.unshift("v"),d=b[1],e=b[0],c.namespaces[e]||c.namespaces.add(e,"urn:schemas-microsoft-com:vml"),c.createElement("<"+e+":"+d+' class="rvml">')}function Vd(a,b,c,d){this.nodeName="#document-fragment",this.children=a,this.key=b,this.val=c,this.index=d,this.props={}}function Yd(){var a,c,b;if(!(n.isRunningActions===!0||n.inTransaction>0)){for(n.isRunningActions=!0,a=n.pendingActions.splice(0,n.pendingActions.length),b=0;c=a[b++];)c.update(),delete n.uniqActions[c.uuid];n.isRunningActions=!1}}function Zd(a){var d,c,b=a.observers;for(c=0;d=b[c++];)d.schedule()}function $d(a){var b=n.trackingAction||null;null!==b&&(n.track("征收到",a.expr),b.mapIDs[a.uuid]=a)}function ae(a,b){var c,e,d;if(a.observers){c=n.trackingAction,c&&_d.push(c),n.trackingAction=a,n.track("【action】",a.type,a.expr,"开始征收依赖项"),a.mapIDs={},d=!0;try{e=b.call(a),d=!1}finally{if(d)n.warn("collectDeps fail",b+""),a.mapIDs={},n.trackingAction=c;else{n.trackingAction=_d.pop();try{be(a)}catch(f){n.warn(f)}}return e}}}function be(a){var f,g,h,i,k,j,b=a.observers,c=[],d={},e=[];for(f in a.mapIDs)if(g=a.mapIDs[f],!g.isAction){if(!g.observers){delete a.mapIDs[f];continue}if(e.push(g.uuid),c.push(g),d[g.uuid]=1,g.lastAccessedBy===a.uuid)continue;g.lastAccessedBy=a.uuid,n.Array.ensure(g.observers,a)}if(e=e.sort().join(","),e!==a.ids){if(a.ids=e,a.isComputed){a.depsCount=c.length,a.deps=n.mix({},a.mapIDs),a.depsVersion={};for(h in a.mapIDs)i=a.mapIDs[h],a.depsVersion[i.uuid]=i.version}else a.observers=c;for(j=0;k=b[j++];)d[k.uuid]||n.Array.remove(k.observers,a)}}function ce(a,b,c){var d,e;return c=c||[],d="transaction "+(a.name||a.displayName||"noop"),de(d),e=a.apply(b,c),ee(d),e}function de(){n.inTransaction+=1}function ee(){0===--n.inTransaction&&(n.isRunningActions=!1,Yd())}function ie(a){var b="??"+fe++;return ge.map[b]=a,b+" "}function je(a){var b=ge.map[a];return b}function ke(a){var c,d,b=le(a);for(c=0,d=b.length;d>c;c++)a=a.replace(b[c],ie);return a}function le(a,b,c){var f,g,d=!1,e=0;for(b=b||0,c=c||[],f=a.length;f>b;b++)g=a.charAt(b),d?g===d&&(c.push(a.slice(e,b+1)),d=!1):"'"===g?(d="'",e=b):'"'===g&&(d='"',e=b);return d!==!1?le(a,e+1,c):c}function ze(a){return a.replace(ue,ie).replace(xe,function(a){return ne[a]?a:"__vmodel__."+a})}function Ae(a,b){var e,f,g,c=a+":"+b,d=ye.get(c);return d?d.slice(0):(ge.map={},e=a.replace(te,function(a,b){return b+ie(a.slice(b.length))}),e=ke(e),e=e.replace(qe,ie).replace(pe,"$1").replace(ve,function(a,b,c){return b+ie(c)+":"}).replace(oe,"$1__vmodel__.").replace(we,function(a,b){return"|"+ie(b)}),e=ze(e),f=e.split(se),g=f.shift().replace(he,je).trim(),/\?\?\d/.test(g)&&(g=g.replace(he,je)),f.length?(f=f.map(function(a){var c,b="";return a=a.replace(re,function(a,c){return/\S/.test(c)&&(b+=","+c),""}),c="["+n.quote(a.trim())+b+"]"}),f="avalon.composeFilters("+f+")(__value__)",f=f.replace(he,je)):f="",ye.put(c,[g,f]))}function De(a){return Be.test(a)&&(a+="($event)"),9>f&&(a=a.replace(Ce,function(a,b,c){return"__vmodel__."+b+".call(__vmodel__"+(/\S/.test(c)?","+c:"")+")"})),a}function Ee(a,b){var d,c=Ae(a,b);d=c[1]?c[1].replace(/__value__\)$/,c[0]+")"):c[0];try{return new Function("__vmodel__","return "+d+";")}catch(e){return n.log("parse getter: [",a,d,"]error"),n.noop}}function Fe(a,b){var c=Ae(a,b),d="try{ "+c[0]+' = __value__}catch(e){avalon.log(e, "in on dir")}';try{return new Function("__vmodel__","__value__",d+";")}catch(e){return n.log("parse setter: ",a," error"),n.noop}}function He(a,b,c){var d,e;for(d in b)1!==Je[d]&&(this[d]=b[d]);this.vm=a,this.observers=[],this.callback=c,this.uuid=++Ge,this.ids="",this.mapIDs={},this.isAction=!0,e=this.expr,"function"!=typeof this.getter&&(this.getter=Ee(e,this.type)),"duplex"===this.type&&(this.setter=Fe(e,this.type)),this.value=0/0,this.node||(this.value=this.get())}function Ie(a){var b,c,d,e,f;if(a&&"object"==typeof a){if(a&&a.$events)return a.$model;if(Array.isArray(a)){for(b=[],c=0,d=a.length;d>c;c++)b.push(Ie(a[c]));return b}e={};for(f in a)e[f]=Ie(a[f]);return e}return a}function Le(a,b,c){if(this.expr=a,b){var d=r.createProxy(b,this);d&&(b=d)}this.value=b,this.vm=c;try{c.$mutations[a]=this}catch(e){}this.uuid=++Ke,this.updateVersion(),this.mapIDs={},this.observers=[]}function Me(a){var b=a.toString();return b.substring(b.indexOf("{}")+1,b.lastIndexOf("}"))}function Oe(a){var b=function(){};return b.prototype=a,new b}function Pe(a,b){if("function"==typeof b){var c=a.prototype=Oe(b.prototype);c.constructor=a}}function Re(a,b){n.mix(this,a),n.mix(this,Qb),this.$hashcode=n.makeHashCode("$"),this.$id=this.$id||this.$hashcode,this.$events={__dep__:b||new Le(this.$id)},n.config.inProxyMode?(delete this.$mutations,this.$accessors={},this.$computed={},this.$track=""):this.$accessors={$model:Xe},void 0===b?(this.$watch=r.watchFactory(this.$events),this.$fire=r.fireFactory(this.$events)):(delete this.$watch,delete this.$fire)}function Te(a,b,c){return a in Qb?!1:"$"===a.charAt(0)?c?(Se[a]||(Se[a]=1,n.warn("ms-for中的变量"+a+"不再建议以$为前缀")),!0):!1:null==b?(n.warn("定义vmodel时"+a+"的属性值不能为null undefine"),!0):/error|date|function|regexp/.test(n.type(b))?!1:!(b&&b.nodeName&&b.nodeType)}function Ue(a,b){if(a&&a.$events)return a;var c;return Array.isArray(a)?c=r.listFactory(a,!1,b):D(a)&&(c=r.modelFactory(a,b)),c}function Ve(a,b,c){var d=null,e=c?Qe:Le;return{get:function(){return d||(d=new e(a,b,this)),d.get()},set:function(c){d||(d=new e(a,b,this)),d.set(c)},enumerable:!0,configurable:!0}}function We(a){var c,d,e,f,b=n.type(a);if("array"===b){for(c=[],d=0;d<a.length;d++)c[d]=We(a[d]);return c}return"object"===b&&"string"==typeof a.$track?(e={},f=a.$track.match(/[^☥]+/g)||[],f.forEach(function(b){var c=a[b];e[b]=c&&c.$events?We(c):c}),e):a}function $e(a){for(var b in Ze)r.hideProperty(a,b,Ze[b])}function af(a,b,c){var d,e,f,h;for(b||($e(a),g&&Object.defineProperty(a,"$model",r.modelAccessor),r.hideProperty(a,"$hashcode",n.makeHashCode("$")),r.hideProperty(a,"$events",{__dep__:c||new Le})),d=a.$events&&a.$events.__dep__,e=0,f=a.length;f>e;e++)h=a[e],D(h)&&(a[e]=r.createProxy(h,d));return a}function df(a,b,c){bf?Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0}):cf[b]||(a[b]=c)}function ef(a){return function(b,c,d){var e=new He(a.__proxy__,{deep:d,type:"user",expr:b},c);return a[b]?a[b].push(e):a[b]=[e],function(){e.dispose(),n.Array.remove(a[b],e),0===a[b].length&&delete a[b]}}}function ff(a){return function(b,c){var f,e,d=a[b];if(Array.isArray(d))for(e=0;f=d[e++];)f.callback.call(f.vm,c,f.value,f.expr)}}function gf(a){return"☥"+a+"☥"}function hf(a,b,c,d){function j(b){return gf(a.$track).indexOf(gf(b))>-1}var f,g,h,i,e=a.$accessors;for(f in Qb)n.msie<9&&void 0===b[f]||df(a,f,b[f]);for(g=0;g<c.length;g++)if(h=c[g],!(h in e)){if(i=b[h],d&&"function"==typeof i){a[h]=i.bind(a),a[h]._orig=i;continue}a[h]=i}a.$track=c.join("☥"),n.msie<9&&(a.hasOwnProperty=j),a.$events.__proxy__=a}function tf(a){var c,b=[];for(c in a)b.push(c);return b}function uf(a,b,c){if(0===c)return a===b;if(null===a&&null===b)return!0;if(void 0===a&&void 0===b)return!0;var d=Array.isArray(a);return d!==Array.isArray(b)?!1:d?vf(a,b,c):"object"==typeof a&&"object"==typeof b?wf(a,b,c):a===b}function vf(a,b,c){if(a.length!==b.length)return!1;for(var d=a.length-1;d>=0;d--)try{if(!uf(a[d],b[d],c-1))return!1}catch(e){return!1}return!0}function wf(a,b,c){if(null===a||null===b)return!1;if(tf(a).length!==tf(b).length)return!1;for(var d in a){if(!(d in b))return!1;try{if(!uf(a[d],b[d],c-1))return!1}catch(e){return!1}}return!0}function Nf(){var a=Mf[0];a&&a()}function Of(a,b,c){a[b]||(a[b]=c)}function Qf(a,b,c){var f,e,d=[].concat(a[b]);for(e=0;f=d[e++];)"function"==typeof f&&f(c)}function Sf(a){var b=a.toLowerCase();return function(c){var g,h,i,j,d=this.dom,e=n(d),f=isFinite(c.stagger)?1e3*c.stagger:0;f&&c.staggerKey&&(g=Rf.get(c.staggerKey)||Rf.put(c.staggerKey,{count:0,items:0}),g.count++,g.items++),h=g&&g.count||0,j=function(b){var f,e=b!==!1;0===--d.__ms_effect_&&(n.unbind(d,Df),n.unbind(d,Cf)),clearTimeout(i),f=e?"Done":"Abort",Qf(c,"on"+a+f,d),g&&0===--g.items&&(g.count=0),c.queue&&(Mf.shift(),Nf())},Qf(c,"onBefore"+a,d),c[b]?c[b](d,function(a){j(a!==!1)}):yf&&(e.addClass(c[b+"Class"]),e.removeClass(Uf(c,b)),d.__ms_effect_?d.__ms_effect_++:(e.bind(Df,j),e.bind(Cf,j),d.__ms_effect_=1),setTimeout(function(){var a=0/0===n.root.offsetWidth;e.addClass(c[b+"ActiveClass"]),a=Zf(d),0===!a?j(!1):f||(i=setTimeout(function(){j(!1)},a+32))},17+f*h))}}function Tf(a){return a.action?void 0:a.action=a.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase()}function Uf(a,b){var b="leave"===b?"enter":"leave";return Array(b+"Class",b+"ActiveClass").map(function(b){return a[b]}).join(" ")}function Yf(a){var b=Xf.test(a)?1e3:1;return parseFloat(a)*b}function Zf(a){var b=m.getComputedStyle(a,null),c=b[Vf],d=b[Wf];return Yf(c)||Yf(d)}function _f(a,b){var f,c=a.ownerDocument,d=a.nodeName,e="_"+d;return _f[e]||(f=c.body.appendChild(c.createElement(d)),b=n.css(f,"display"),c.body.removeChild(f),b===$f&&(b="block"),_f[e]=b),_f[e]}function ag(a,b){var c=a.innerRender=n.scan(a.fragment,a.vm);n.shadowCopy(b,c.root),delete b.nodeValue}function bg(a,b){a.children&&a.children.forEach(function(a){"option"===a.nodeName?cg(a,b):bg(a,b)})}function cg(a,b){var d,c=a.props;"disabled"in c||(d=dg(a,c),d=String(d||"").trim(),c.selected="string"==typeof b?d===b:-1!==b.indexOf(d),a.dom&&(a.dom.selected=c.selected,a.dom.selected))}function dg(a,b){if(b&&"value"in b)return b.value+"";var c=[];return a.children.forEach(function(a){"#text"===a.nodeName?c.push(a.nodeValue):"#document-fragment"===a.nodeName&&c.push(dg(a))}),c.join("")}function eg(a,b){return a.children.forEach(function(a){"option"===a.nodeName?a.props.selected===!0&&b.push(dg(a,a.props)):a.children&&eg(a,b)}),b}function gg(a){a.userCb&&a.userCb.call(a.vm,{type:"changed",target:a.dom})}function hg(){var d,f,g,b=this,c=b._ms_duplex_;if(!b.composing&&b.value!==c.value){if(b.caret)try{d=c.getCaret(b),c.pos=d}catch(e){}c.debounceTime>4?(f=new Date,g=f-c.time||0,c.time=f,g>=c.debounceTime?fg[c.dtype].call(c):(clearTimeout(c.debounceID),c.debounceID=setTimeout(function(){fg[c.dtype].call(c)},g))):c.isChanged?setTimeout(function(){fg[c.dtype].call(c)},4):fg[c.dtype].call(c)}}function kg(){var b,a=this.expr;ig.test(a)&&(this.isChanged=!0,a=a.replace(ig,"")),b=a.match(jg),b&&(a=a.replace(jg,""),this.isChanged||(this.debounceTime=parseInt(b[1],10)||300)),this.expr=a}function lg(){var b,c,e,d,f,g,h,i;this.expr,b=this.node,c=b.props.type,this.parseValue=ug,d=this.param,f=!1,d=d?d.split("-").map(function(a){return"checked"===a&&(f=!0),a}):[],b.duplex=this,bc.test(c)&&f&&(d=[],e="radio",this.isChecked=f),this.parsers=d,/input|textarea|select/.test(b.nodeName)?e||(e="select"===b.nodeName?"select":"checkbox"===c?"checkbox":"radio"===c?"radio":"input"):"contenteditable"in b.props&&(e="contenteditable"),this.dtype=e,"input"!==e&&"contenteditable"!==e?(delete this.isChanged,delete this.debounceTime):this.isChecked||(this.isString=!0),g=b.props["data-duplex-changed"],g&&(h=Ae(g,"xx"),i=De(h[0]),this.userCb=new Function("$event","var __vmodel__ = this\nreturn "+i))}function mg(a){if(Array.isArray(a)){if(a+""!==this.compareVal)return this.compareVal=a+"",!0}else if(a=this.parseValue(a),this.isChecked||(this.value=a+=""),a!==this.compareVal)return this.compareVal=a,!0}function ng(a,b){var c=a.dom;this.dom=c,this.vdom=a,this.duplexCb=hg,c._ms_duplex_=this,b(c,this)}function ug(a){var c,b,d;for(b=0;c=this.parsers[b++];)d=n.parsers[c],d&&(a=d.call(this,a));return a}function Ag(a){var b=typeof a;return a&&"object"===b?a.$hashcode:b+":"+a}function Bg(a,b){var c,d,e,f;return D(b)?(c=Array.isArray(b),d=[],e=[],f=0,a.isArray=c,a.fragments?(a.preFragments=a.fragments,n.each(b,function(a,b){var g=c?Ag(b):a;e.push({key:g,val:b,index:f++}),d.push(g)}),a.fragments=e):(n.each(b,function(a,b){if(!(a in Qb)){var g=c?Ag(b):a;e.push(new Vd([],g,b,f++)),d.push(g)}}),a.fragments=e),d.join(";;")):0/0}function Cg(a){var b=a.fragments.map(function(b,c){return Gg(b,a,c),Ig(a.cache,b),b}),c=a.parentChildren,d=c.indexOf(a.begin);c.splice.apply(c,[d+1,0].concat(b))}function Dg(a){var b=a.cache,c={},d=[],e=a.preFragments;e.forEach(function(a){a._dispose=!0}),a.fragments.forEach(function(e,f){var g=Hg(b,e.key);g?(delete g._dispose,g.oldIndex=g.index,g.index=f,Eg(g.vm,a.keyName),g.vm[a.valName]=e.val,g.vm[a.keyName]=a.isArray?f:g.key,Ig(c,g)):d.push(e)}),d.forEach(function(d){var g,h,f=Jg(b,d.key);f?(f.oldIndex=f.index,f.key=d.key,g=f.val=d.val,h=f.index=d.index,f.vm[a.valName]=g,f.vm[a.keyName]=a.isArray?h:f.key,delete f._dispose):(d=new Vd([],d.key,d.val,d.index),f=Gg(d,a,d.index),e.push(f)),Ig(c,f)}),a.fragments=e,e.sort(function(a,b){return a.index-b.index}),a.cache=c}function Eg(a,b){n.config.inProxyMode?a.$accessors[b].value=0/0:a.$accessors[b].set(0/0)}function Fg(a){var g,f,h,i,j,k,l,b=a.begin.dom,c=b.parentNode,d=a.fragments,e=a.end.dom;for(f=0;g=d[f];f++)g._dispose?(d.splice(f,1),f--,g.dispose()):(g.oldIndex!==g.index&&(h=g.toFragment(),i=null===b.nextSibling,c.insertBefore(h,b.nextSibling),i&&!c.contains(e)&&c.insertBefore(e,b.nextSibling)),b=g.split);j=a.parentChildren,k=j.indexOf(a.begin),l=j.indexOf(a.end),d.splice.apply(j,[k+1,l-k].concat(d)),"SELECT"===c.nodeName&&c._ms_duplex_&&vg["select"].call(c._ms_duplex_)}function Gg(a,b,c){var e,d={};return d[b.keyName]=b.isArray?c:a.key,d[b.valName]=a.val,b.asName&&(d[b.asName]=b.value),e=a.vm=r.itemFactory(b.vm,{data:d}),b.isArray?e.$watch(b.valName,function(a){b.value&&b.value.set&&b.value.set(e[b.keyName],a)}):e.$watch(b.valName,function(c){b.value[a.key]=c}),a.index=c,a.innerRender=n.scan(b.fragment,e,function(){var b=this.root;x.push.apply(a.children,b.children),this.root=a}),a}function Hg(a,b){var d,e,c=a[b];return c?(d=c.arr)?(e=d.pop(),d.length||(c.arr=0),e):(delete a[b],c):void 0}function Ig(a,b){var d,e,c=b.key;a[c]?(d=a[c],e=d.arr||(d.arr=[]),e.push(b)):a[c]=b}function Jg(a){var b,c;for(c in a){b=c;break}return b?Hg(a,b):void 0}function Kg(){var b,c,d,e,a=[];for(b=0;b<arguments.length;b++)if(c=arguments[b],d=typeof c,"string"===d||"number"===d||c===!0)a.push(c);else if(Array.isArray(c))a.push(Kg.apply(null,c));else if("object"===d)for(e in c)c.hasOwnProperty(e)&&c[e]&&a.push(e);return a.join(" ")}function Mg(a){var b=a.target;n(b).addClass(b.getAttribute(Lg[a.type])||"")}function Ng(a){var b=a.target,c=Lg[a.type];n(b).removeClass(b.getAttribute(c)||""),"change-active"!==c&&n(b).removeClass(b.getAttribute("change-active")||"")}function Og(a,b){var c=a.getAttribute("change-class");c!==b&&(n(a).removeClass(c).addClass(b),a.setAttribute("change-class",b))}function Pg(a,b){var d,c={};switch(b.dtype){case"radio":case"checkbox":c.click=hg;break;case"select":c.change=hg;break;case"contenteditable":b.isChanged?c.blur=hg:n.modern?(m.webkitURL?c.webkitEditableContentChanged=hg:m.MutationEvent&&(c.DOMCharacterDataModified=hg),c.input=hg):(c.keydown=Wg,c.paste=Rg,c.cut=Rg,c.focus=Vg,c.blur=Ug);break;case"input":b.isChanged?c.change=hg:10>f?(c.propertychange=Qg,c.paste=Rg,c.cut=Rg,c.keyup=Wg):(c.input=hg,c.compositionstart=Ug,c.compositionend=Vg,/\[native code\]/.test(m.Int8Array)||(c.keydown=Wg,c.paste=Rg,c.cut=Rg,m.netscape&&(c.DOMAutoComplete=hg)))
}/password|text/.test(a.type)&&(c.focus=Sg,c.blur=Tg,b.getCaret=Zg,b.setCaret=Yg);for(d in c)n.bind(a,d,c[d])}function Qg(a){"value"===a.propertyName&&hg.call(this,a)}function Rg(a){var b=this;setTimeout(function(){hg.call(b,a)},0)}function Sg(){this.caret=!0}function Tg(){this.caret=!1}function Ug(){this.composing=!0}function Vg(a){this.composing=!1,Rg.call(this,a)}function Wg(a){var b=a.keyCode;91===b||b>15&&19>b||b>=37&&40>=b||hg.call(this,a)}function Yg(a,b){var c;a.createTextRange?Xg(function(){a.focus(),c=a.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}):(a.focus(),void 0!==a.selectionStart&&a.setSelectionRange(b,b))}function Zg(a){var d,e,f,g,h,b=0;return a.selectionStart+a.selectionEnd>-1?b=a.selectionStart:(e=c.selection.createRange(),e&&e.parentElement()===a&&(g=a.value.length,d=a.value.replace(/\r\n/g,"\n"),f=a.createTextRange(),f.moveToBookmark(e.getBookmark()),h=a.createTextRange(),h.collapse(!1),f.compareEndPoints("StartToEnd",h)>-1?b=g:(b=-f.moveStart("character",-g),b+=d.slice(0,b).split("\n").length-1))),b}function $g(a,b){var d,c=this.dom;return this.isString&&b&&!a&&!c.valueHijack?(c.valueHijack=hg,d=setInterval(function(){n.contains(n.root,c)?c.valueHijack({type:"poll"}):clearInterval(d)},30)):void 0}function ah(a){return"regexp"===n.type(a)}function dh(a){var b,c,d,e,f;return"string"==typeof a&&a&&(b=a.split("-"),3===b.length&&4===b[0].length)?(c=~~b[0],d=~~b[1]-1,e=~~b[2],f=new Date(c,d,e),f.getFullYear()===c&&f.getMonth()===d&&f.getDate()===e):!1}function fh(a){for(;"FORM"!==a.tagName;)a=a.parentNode;return a._ms_validate_}function gh(a){a.preventDefault();var b=fh(a.target);b&&b.onManual&&b.onManual()}function hh(a,b,c){var e,d,f;for(d=0;e=a[d++];)f=e.rules&&e.duplex,f?(b.push(f),kh(f,c)):e.children?hh(e.children,b,c):Array.isArray(e)&&hh(e,b,c)}function ih(a){var e,b=a.target,c=b._ms_duplex_,d=(c||{}).vdom;c&&d.rules&&!c.validator&&(e=fh(b),e&&n.Array.ensure(e.fields,c)&&kh(c,e))}function jh(a){var b=a.target,c=b._ms_duplex_,d=fh(a.target);d&&d.validate(c,0,a)}function kh(a,b){var c=a.dom;a.validator||(a.validator=b,!b.validateInKeyup||a.isChanged||a.debounceTime||n.bind(c,"keyup",jh),b.validateInBlur&&n.bind(c,"blur",jh),b.resetInFocus&&n.bind(c,"focus",function(a){var b=a.target,c=b._ms_duplex_,d=fh(a.target);d&&d.onReset.call(b,a,c)}))}function mh(){var a=this.data||{};return this.message.replace(lh,function(b,c){return null==a[c]?"":a[c]})}function nh(a,c,d,e){var h,i,j,k,f=c.type,g=n.directives[f];b&&(h=n.vdom(d,"toDOM"),1===h.nodeType&&h.removeAttribute(c.attrName),d.dom=h),i=g.update?function(a){!e.mount&&/css|visible|duplex/.test(f)?e.callbacks.push(function(){g.update.call(k,k.node,a)}):g.update.call(k,k.node,a)}:n.noop;for(j in g)c[j]=g[j];return c.node=d,k=new He(a,c,i),k.init&&k.init(),k.update(),k}function ph(a,b){var g,h,i,k,l,m,o,q,p,c=b[0],d={},e=[],f=!1;for(g in a)if(h=a[g],i=g.split("-"),k=g in c.props?g:":"+g.slice(3),oh[i[1]]&&i.splice(1,0,"on"),"on"===i[1]&&(i[3]=parseFloat(i[3])||0),l=i[1],"controller"!==l&&"important"!==l&&j[l]&&(m={type:l,param:i[2],attrName:k,name:i.join("-"),expr:h,priority:j[l].priority||100*l.charCodeAt(0)},"if"===l&&(f=!0),"on"===l&&(m.priority+=i[3]),!d[m.name]&&(d[m.name]=h,e.push(m),"for"===l)))return[n.mix(m,b[3])];if(e.sort(qh),f)for(o=[],p=0;q=e[p++];)if(o.push(q),"if"===q.type)return o;return e}function qh(a,b){return a.priority-b.priority}function th(a){var e,f,g,h,b=/\n\r?/g,c=a.nodeValue.trim().replace(b,""),d=[];do e=c.indexOf(Z.openTag),e=-1===e?c.length:e,f=c.slice(0,e),/\S/.test(f)&&d.push(n.quote(n._decode(f))),c=c.slice(e+Z.openTag.length),c&&(e=c.indexOf(Z.closeTag),f=c.slice(0,e),g=n.unescapeHTML(f),/\|\s*\w/.test(g)&&(h=Ae(g,"expr"),h[1]&&(g=h[1].replace(sh,h[0]+")"))),rh&&(g="("+g+")"),d.push(g),c=c.slice(e+Z.closeTag.length));while(c.length);return[{expr:d.join("+"),name:"expr",type:"expr"}]}function uh(a){var d,c,b=0;for(c=0;d=a[c++];)b+="#document-fragment"===d.nodeName?uh(d.children):1;return b}function vh(a,b){b&&b.forEach(function(b){var c,d,e,f;if(b){c=b.children&&uh(b.children),"#document-fragment"===b.nodeName?d=W():(d=n.vdom(b,"toDOM"),e=d.childNodes&&d.childNodes.length,e&&c&&e>c&&(zh[d.nodeName]||n.clearHTML(d))),c&&(vh(d,b.children),"select"===b.nodeName&&(f=[],eg(b,f),bg(b,f)));try{zh[a.nodeName]||a.appendChild(d)}catch(g){}}})}function wh(a){if(a)for(var b;b=a.firstChild;)1===b.nodeType&&wh(b),a.removeChild(b)}function xh(a,b){var f,c=a.indexOf(b)+1,d=1,e=[];for(e.start=c;b=a[c++];)if(e.push(b),"#comment"===b.nodeName)if(yh(b.nodeValue,"ms-for:"))d++;else if("ms-for-end:"===b.nodeValue&&(d--,0===d)){f=b,e.pop();break}return e.end=f,e}function yh(a,b){return 0===a.indexOf(b)}function Ah(a,b,c){this.root=a,this.vm=b,this.beforeReady=c,this.bindings=[],this.callbacks=[],this.directives=[],this.init()}function Ch(){var c,d,e,a=this.beforeUpdate(),b=this.value=this.get();this.callback&&this.diff(b,a)&&(this.callback(this.node,this.value),c=this.vm,d=c.$render,e=c.$events["onViewChange"],e&&d&&d.root&&!n.viewChanging&&(Bh&&(clearTimeout(Bh),Bh=null),Bh=setTimeout(function(){e.forEach(function(a){a.callback.call(c,{type:"viewchange",target:d.root,vmodel:c})})}))),this._isScheduled=!1}function Fh(a){var b;return a=r.toJson(a),Array.isArray(a)?(b={},a.forEach(function(a){a&&n.shadowCopy(b,a)}),b):a}function Hh(a,b){var c,d,e,f;a.innerRender=b,c=b.root,d=a.node,e=d.props.slot;for(f in c)d[f]=c[f];d.props&&e&&(d.props.slot=e),b.root=d,b.vnodes[0]=d}function Ih(a,b,c){var d=a.$events["on"+c];d&&d.forEach(function(d){setTimeout(function(){d.callback.call(a,{type:c.toLowerCase(),target:b.dom,vmodel:a})},0)})}function Jh(a,b,c){var f,g,h,i,j,d=[],e=a.defaults;Kh(e,d),Kh(b,d),f={};for(g in e)h=b[g],f[g]=null==h?e[g]:h;return f.$id=b.id||b.$id||n.makeHashCode(c),delete f.id,i=n.mix(!0,{},f),j=n.define(i),d.forEach(function(a){j.$watch(a.type,a.cb)}),j}function Kh(a,b){for(var c in a)Eh[c]&&"function"==typeof a[c]&&0===c.indexOf("on")&&b.unshift({type:c,cb:a[c]})}function Lh(a,b){var c=b&&b[0]&&b[0].forDir;c&&(c.parentChildren=a)}function Mh(a,b){for(var d,c=0;d=a[c];c++){if("slot"===d.nodeName){Lh(a,b),a.splice.apply(a,[c,1].concat(b));break}d.children&&Mh(d.children,b)}}function Nh(a,b){var d,c,e;for(c=0;d=a[c];c++)"slot"!==d.nodeName?d.children&&Nh(d.children,b):(e=d.props.name,Lh(a,b[e]),a.splice.apply(a,[c,1].concat(b[e])))}function Oh(a,b){n.components[a]=b;for(var c,d=0;c=Gh[d];d++)c.is===a&&(Gh.splice(d,1),c.reInit=!0,delete c.value,c.update(),d--);return b}function Ph(a){var c,b=a.displayName;return delete a.displayName,c={defaults:n.mix(!0,{},this.defaults,a.defaults)},a.soleSlot&&(c.soleSlot=a.soleSlot),c.template=a.template||this.template,n.component(b,c)}var i,j,m,p,q,r,t,v,w,x,y,F,H,J,L,O,Q,S,T,U,V,X,Y,$,bb,cb,db,eb,fb,ib,jb,kb,mb,ob,pb,sb,tb,vb,zb,Ab,Bb,Cb,Kb,Lb,Mb,Ob,Pb,Qb,Yb,Zb,$b,ac,bc,jc,kc,lc,nc,oc,pc,qc,sc,tc,vc,xc,yc,zc,Ac,Dc,Ec,Fc,Gc,Hc,Jc,Mc,Nc,Pc,Qc,Sc,Tc,Uc,Vc,Xc,bd,ed,id,jd,kd,ld,md,od,qd,sd,ud,wd,xd,yd,zd,Cd,Ed,Id,Pd,Rd,Sd,Ud,Wd,_d,fe,ge,he,me,ne,oe,pe,qe,re,se,te,ue,ve,we,xe,ye,Be,Ce,Ge,Je,Ke,Ne,Qe,Se,Xe,Ye,Ze,_e,bf,cf,jf,kf,lf,mf,nf,of,pf,qf,rf,sf,xf,yf,zf,Af,Bf,Cf,Df,Ef,Ff,Hf,If,Jf,Kf,Lf,Mf,Pf,Rf,Vf,Wf,Xf,$f,fg,ig,jg,og,pg,qg,rg,sg,tg,vg,wg,xg,yg,zg,Lg,Xg,_g,bh,ch,eh,lh,oh,rh,sh,zh,Bh,Dh,Eh,Gh,a="object"==typeof window?window:"object"==typeof global?global:{},b=!!a.location&&a.navigator,c=b?a.document:{createElement:Object,createElementNS:Object,documentElement:"xx",contains:Boolean},d=b?c.documentElement:{outerHTML:"x"},e={objectobject:7,objectundefined:6,undefinedfunction:0/0,undefinedobject:0/0},f=c.documentMode||e[typeof c.all+typeof XMLHttpRequest],g=/NaN|undefined/.test(f)||f>8;h.prototype={put:function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},shift:function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key],this.size--)},get:function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)}},i={},j={},m=a,n.init=function(a){this[0]=this.element=a},n.fn=n.prototype=n.init.prototype,p=/[^, ]+/g,q=/\S+/g,r={},t=Object.prototype,v=t.toString,w=t.hasOwnProperty,x=Array.prototype,y="object"==typeof console,n.config={debug:!0},F=/([a-z\d])([A-Z]+)/g,H=/[-_][^-_]/g,J=x.slice,L=/\d\.\d{4}/,O=1,Q=/[-.*+?^${}()|[\]\/\\]/g,S={},T={},U={},V={},m.avalon=n,X=/&[a-z0-9#]{2,10};/,Y=c.createElement("div"),o(n,{Array:{merge:function(a,b){a.push.apply(a,b)},ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?n.Array.removeAt(a,c):!1}},evaluatorPool:new h(888),parsers:{number:function(a){return""===a?"":parseFloat(a)||0},string:function(a){return null===a||void 0===a?"":a+""},"boolean":function(a){return""===a?a:"true"===a||"1"===a}},_decode:function(a){return X.test(a)?(Y.innerHTML=a,Y.innerText||Y.textContent):a}}),$={interpolate:function(a){var d,e,f,b=a[0],c=a[1];if(b===c)throw new SyntaxError("interpolate openTag cannot equal to closeTag");if(d=b+"test"+c,/[<>]/.test(d))throw new SyntaxError('interpolate cannot contains "<" or ">"');Z.openTag=b,Z.closeTag=c,e=R(b),f=R(c),Z.rtext=new RegExp(e+"(.+?)"+f,"g"),Z.rexpr=new RegExp(e+"([\\s\\S]*)"+f)}},Z.plugins=$,Z({interpolate:["{{","}}"],debug:!0}),o(n,{shadowCopy:o,oneObject:s,inspect:v,ohasOwn:w,rword:p,version:"2.2.10",vmodels:{},directives:j,directive:k,eventHooks:S,eventListeners:T,validators:U,cssHooks:V,log:z,noop:C,warn:A,error:B,config:Z,modern:g,msie:f,root:d,document:c,window:m,inBrowser:b,isObject:D,range:E,slice:K,hyphen:G,camelize:I,escapeRegExp:R,quote:u,makeHashCode:M}),ab("司徒正美".trim)||(bb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.prototype.trim=function(){return this.replace(bb,"")}),Object.create||(Object.create=function(){function a(){}return function(b){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),cb=!{toString:null}.propertyIsEnumerable("toString"),db=function(){}.propertyIsEnumerable("prototype"),eb=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],fb=eb.length,ab(Object.keys)||(Object.keys=function(a){var d,e,f,g,h,i,b=[],c=db&&"function"==typeof a;if("string"==typeof a||a&&a.callee)for(d=0;d<a.length;++d)b.push(String(d));else for(e in a)c&&"prototype"===e||!w.call(a,e)||b.push(String(e));if(cb)for(f=a.constructor,g=f&&f.prototype===a,h=0;fb>h;h++)i=eb[h],g&&"constructor"===i||!w.call(a,i)||b.push(i);return b}),ab(Array.isArray)||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),ab(ab.bind)||(Function.prototype.bind=function(a){if(arguments.length<2&&void 0===a)return this;var b=this,c=arguments;return function(){var e,d=[];for(e=1;e<c.length;e++)d.push(c[e]);for(e=0;e<arguments.length;e++)d.push(arguments[e]);return b.apply(a,d)}});try{J.call(n.document.documentElement)}catch(gb){x.slice=function(a,b){var c,e,d,f,g,h;if(b="undefined"!=typeof b?b:this.length,Array.isArray(this))return J.call(this,a,b);if(d=[],f=this.length,g=a||0,g=g>=0?g:f+g,h=b?b:f,0>b&&(h=f+b),e=h-g,e>0)if(d=new Array(e),this.charAt)for(c=0;e>c;c++)d[c]=this.charAt(g+c);else for(c=0;e>c;c++)d[c]=this[g+c];return d}}ab(x.map)||n.shadowCopy(x,{indexOf:function(a,b){var c=this.length,d=~~b;for(0>d&&(d+=c);c>d;d++)if(this[d]===a)return d;return-1},lastIndexOf:function(a,b){var c=this.length,d=null==b?c-1:b;for(0>d&&(d=Math.max(0,c+d));d>=0;d--)if(this[d]===a)return d;return-1},forEach:hb("","_",""),filter:hb("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:hb("r=[],","r[i]=_","return r"),some:hb("","if(_)return true","return false"),every:hb("","if(!_)return false","return true")}),ib=function(){var a={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},b="000000",c=function(a,c){return(b+(c||0)).slice(-a)},d="\\u00",e=function(b){var e=b.charCodeAt(0),f=a[e];return f?f:d+c(2,e.toString(16))},f=/[\x00-\x1f\x22\x5c]/g;return function(a){return f.lastIndex=0,'"'+(f.test(a)?String(a).replace(f,e):a)+'"'}}();try{n._quote=8>=msie?ib:JSON.stringify}catch(gb){n._quote=ib}jb={},"Boolean Number String Function Array Date RegExp Object Error".replace(n.rword,function(a){jb["[object "+a+"]"]=a.toLowerCase()}),n.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?jb[v.call(a)]||"object":typeof a},kb=/^\s*\bfunction\b/,n.isFunction="object"==typeof alert?function(a){try{return kb.test(a+"")}catch(b){return!1}}:function(a){return"[object Function]"===v.call(a)},mb=/^\[object (?:Window|DOMWindow|global)\]$/,n.isWindow=nb(n.window)?nb:lb;for(ob in n({}))break;pb="0"!==ob,n.isPlainObject=/\[native code\]/.test(Object.getPrototypeOf)?rb:qb,sb=/object|function/,n.mix=n.fn.mix=function(){var e,a=arguments.length,b=!1,c=0,d=[];for(arguments[0]===!0&&(b=!0,c=1);a>c;c++)e=arguments[c],e=e&&sb.test(typeof e)?e:{},d.push(e);return 1===d.length&&d.unshift(this),ub(b,d)},vb=/(Array|List|Collection|Map|Arguments)\]$/,n.each=function(a,b){var c,d;if(a)if(c=0,wb(a))for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},function(){var c,d,a=["%cavalon.js %c"+n.version+" %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],b="You're running avalon in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n\n  avalon.config({debug: false});\n\nDebug mode also automatically shut down amicably when your app is minified.\n\nGet help and support:\n  https://segmentfault.com/t/avalon\n  http://avalonjs.coding.me/\n  http://www.baidu-x.com/?q=avalonjs\n  http://www.avalon.org.cn/\n\nFound a bug? Raise an issue:\n  https://github.com/RubyLouvre/avalon/issues\n\n";"object"==typeof console&&(c=console,d=c.groupCollapsed||c.log,Function.apply.call(d,c,a),c.log(b),d!==console.log&&c.groupEnd(a))}(),zb=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Ab=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Bb=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,Cb={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},Kb={yyyy:Gb("FullYear",4),yy:Gb("FullYear",2,0,!0),y:Gb("FullYear",1),MMMM:Hb("Month"),MMM:Hb("Month",!0),MM:Gb("Month",2,1),M:Gb("Month",1,1),dd:Gb("Date",2),d:Gb("Date",1),HH:Gb("Hours",2),H:Gb("Hours",1),hh:Gb("Hours",2,-12),h:Gb("Hours",1,-12),mm:Gb("Minutes",2),m:Gb("Minutes",1),ss:Gb("Seconds",2),s:Gb("Seconds",1),sss:Gb("Milliseconds",3),EEEE:Hb("Day"),EEE:Hb("Day",!0),a:Jb,Z:Ib},Lb=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Mb=/^\/Date\((\d+)\)\/$/,Ob={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},Ob.SHORTMONTH=Ob.MONTH,Nb.locate=Ob,Qb={$id:Pb,$render:Pb,$track:Pb,$element:Pb,$computed:Pb,$watch:Pb,$fire:Pb,$events:Pb,$accessors:Pb,$hashcode:Pb,$mutations:Pb,$vbthis:Pb,$vbsetter:Pb},Yb={stop:function(a){return a.stopPropagation(),a},prevent:function(a){return a.preventDefault(),a}},Zb={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};for($b in Zb)!function(a,b){Yb[a]=function(a){return a.which!==b&&(a.$return=!0),a}}($b,Zb[$b]);ac=n.filters={},n.composeFilters=function(){var a=arguments;return function(b){var d,c,e,f;for(c=0;d=a[c++];)if(e=d[0],f=n.filters[e],"function"==typeof f){d[0]=b;try{b=f.apply(0,d)}catch(g){}}return b}},n.escapeHtml=_b,n.mix(ac,{uppercase:function(a){return String(a).toUpperCase()},lowercase:function(a){return String(a).toLowerCase()},truncate:function(a,b,c){return a?(a=String(a),isNaN(b)&&(b=30),c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:a):""},camelize:n.camelize,date:Nb,escape:_b,sanitize:Db,number:yb,currency:function(a,b,c){return(b||"¥")+yb(a,isFinite(c)?c:2)}},{filterBy:Tb,orderBy:Rb,selectBy:Ub,limitBy:Vb},Yb),bc=/^(?:checkbox|radio)$/,n.contains=fc,n.cloneNode=function(a){return a.cloneNode(!0)},b&&gc(),hc.prototype={toString:function(){var a=this.node,b=a.className,c="string"==typeof b?b:b.baseVal,d=c.match(q);return d?d.join(" "):""},contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},add:function(a){this.contains(a)||this.set(this+" "+a)},remove:function(a){this.set((" "+this+" ").replace(" "+a+" "," "))},set:function(a){a=a.trim();var b=this.node;"object"==typeof b.className?b.setAttribute("class",a):b.className=a,a||b.removeAttribute("class")}},"add,remove".replace(p,function(a){n.fn[a+"Class"]=function(b){var c=this[0]||{};return b&&"string"==typeof b&&1===c.nodeType&&b.replace(q,function(b){ic(c)[a](b)}),this}}),n.shadowCopy(n.fn,{hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&ic(b).contains(a)},toggleClass:function(a,b){var c="boolean"==typeof b,d=this;return String(a).replace(q,function(a){var e=c?b:!d.hasClass(a);d[e?"addClass":"removeClass"](a)}),this}}),jc={},"accept-charset,acceptCharset|char,ch|charoff,chOff|class,className|for,htmlFor|http-equiv,httpEquiv".replace(/[^\|]+/g,function(a){var b=a.split(",");jc[b[0]]=b[1]}),kc=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),kc.replace(/\w+/g,function(a){jc[a.toLowerCase()]=a}),lc=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(","),lc.replace(/\w+/g,function(a){jc[a.toLowerCase()]=a}),nc=/^[\],:{}\s]*$/,oc=/(?:^|:|,)(?:\s*\[)+/g,pc=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,qc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,sc=/^\[object SVG\w*Element\]$/,tc=/&amp;/g,vc={};try{n.parseJSON=JSON.parse}catch(gb){n.parseJSON=rc}n.fn.attr=function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},xc=s("float","cssFloat"),n.cssNumber=s("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),yc=["","-webkit-","-o-","-moz-","-ms-"],n.cssName=function(a,b,c){if(xc[a])return xc[a];b=b||n.root.style||{};for(var d=0,e=yc.length;e>d;d++)if(c=n.camelize(yc[d]+a),c in b)return xc[a]=c;return null},n.css=function(a,b,c,d){var e,f;if(a instanceof n&&(a=a[0]),1===a.nodeType){if(e=n.camelize(b),b=n.cssName(e)||e,void 0===c||"boolean"==typeof c)return d=V[e+":get"]||V["@:get"],"background"===b&&(b="backgroundColor"),f=d(a,b),c===!0?parseFloat(f)||0:f;if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!n.cssNumber[e]&&(c+="px"),d=V[e+":set"]||V["@:set"],d(a,b,c)}}},n.fn.css=function(a,b){var c,d;if(n.isPlainObject(a))for(c in a)n.css(this,c,a[c]);else d=n.css(this,a,b);return void 0!==d?d:this},n.fn.position=function(){var a,b,c=this[0],d={top:0,left:0};return c?("fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0),d.top-=a.scrollTop(),d.left-=a.scrollLeft()),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}):d},n.fn.offsetParent=function(){for(var a=this[0].offsetParent;a&&"static"===n.css(a,"position");)a=a.offsetParent;return n(a||n.root)},V["@:set"]=function(a,b,c){try{a.style[b]=c}catch(d){}},V["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=m.getComputedStyle(a,null);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},V["opacity:get"]=function(a){var b=V["@:get"](a,"opacity");return""===b?"1":b},"top,left".replace(n.rword,function(a){V[a+":get"]=function(b){var c=V["@:get"](b,a);return/px$/.test(c)?c:n(b).position()[a]+"px"}}),zc={position:"absolute",visibility:"hidden",display:"block"},Ac=/^(none|table(?!-c[ea]).+)/,n.each({Width:"width",Height:"height"},function(a,b){var c="client"+a,d="scroll"+a,e="offset"+a;V[b+":get"]=function(b,c,d){var g,f=-4;return"number"==typeof d&&(f=d),c="Width"===a?["Left","Right"]:["Top","Bottom"],g=b[e],2===f?g+n.css(b,"margin"+c[0],!0)+n.css(b,"margin"+c[1],!0):(0>f&&(g=g-n.css(b,"border"+c[0]+"Width",!0)-n.css(b,"border"+c[1]+"Width",!0)),-4===f&&(g=g-n.css(b,"padding"+c[0],!0)-n.css(b,"padding"+c[1],!0)),g)},V[b+"&get"]=function(a){var d,f,e,g,c=[];for(Bc(a,c),d=V[b+":get"](a),e=0;f=c[e++];){a=f.node;for(g in f)"string"==typeof f[g]&&(a.style[g]=f[g])}return d},n.fn[b]=function(f){var h,g=this[0];return 0===arguments.length?g.setTimeout?g["inner"+a]||g.document.documentElement[c]||g.document.body[c]:9===g.nodeType?(h=g.documentElement,Math.max(g.body[d],h[d],g.body[e],h[e],h[c])):V[b+"&get"](g):this.css(b,f)},n.fn["inner"+a]=function(){return V[b+":get"](this[0],void 0,-2)},n.fn["outer"+a]=function(a){return V[b+":get"](this[0],void 0,a===!0?2:0)}}),9>f&&(n.shadowCopy(xc,s("float","styleFloat")),Dc=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Ec=/^(top|right|bottom|left)$/,Fc=/alpha\([^)]+\)/i,Gc=/(opacity|\d(\d|\.)*)/g,Hc=8===f,Jc={thin:Hc?"1px":"2px",medium:Hc?"3px":"4px",thick:Hc?"5px":"6px"},V["@:get"]=function(a,b){var e,f,g,c=a.currentStyle,d=c[b];return Dc.test(d)&&!Ec.test(d)&&(e=a.style,f=e.left,g=a.runtimeStyle.left,a.runtimeStyle.left=c.left,e.left="fontSize"===b?"1em":d||0,d=e.pixelLeft+"px",e.left=f,a.runtimeStyle.left=g),"medium"===d&&(b=b.replace("Width","Style"),"none"===c[b]&&(d="0px")),""===d?"auto":Jc[d]||d},V["opacity:set"]=function(a,b,c){var d=a.style,e=Number(c)<=1?"alpha(opacity="+100*c+")":"",f=d.filter||"";d.zoom=1,d.filter=(Fc.test(f)?f.replace(Fc,e):f+" "+e).trim(),d.filter||d.removeAttribute("filter")},V["opacity:get"]=function(a){var e,d,b=a.style.filter.match(Gc)||[],c=!1;for(d=0;e=b[d++];)if("opacity"===e)c=!0;else if(c)return e/100+"";return"1"}),n.fn.offset=function(){var c,d,e,f,g,h,i,j,a=this[0],b={left:0,top:0};return a&&a.tagName&&a.ownerDocument?(c=a.ownerDocument,d=c.body,e=c.documentElement,f=c.defaultView||c.parentWindow,n.contains(e,a)?(a.getBoundingClientRect&&(b=a.getBoundingClientRect()),g=e.clientTop||d.clientTop,h=e.clientLeft||d.clientLeft,i=Math.max(f.pageYOffset||0,e.scrollTop,d.scrollTop),j=Math.max(f.pageXOffset||0,e.scrollLeft,d.scrollLeft),{top:b.top+i-g,left:b.left+j-h}):b):b},n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){n.fn[a]=function(c){var d=this[0]||{},e=Cc(d),f=n.root,g="scrollTop"===a;return arguments.length?(e?e.scrollTo(g?n(e).scrollLeft():c,g?c:n(e).scrollTop()):d[a]=c,void 0):e?b in e?e[b]:f[a]:d[a]}}),Mc={"option:get":f?Lc:function(a){return a.value},"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f=Mc["option:get"],g="select-one"===a.type||0>e,h=g?null:[],i=g?e+1:d.length,j=0>e?i:g?e:0;i>j;j++)if(c=d[j],!(!c.selected&&j!==e||c.disabled||c.parentNode.disabled&&"OPTGROUP"===c.parentNode.tagName)){if(b=f(c),g)return b;h.push(b)}return h},"select:set":function(a,b,c){var d,f,e;for(b=[].concat(b),d=Mc["option:get"],e=0;f=a.options[e++];)(f.selected=b.indexOf(d(f))>-1)&&(c=!0);c||(a.selectedIndex=-1)}},n.fn.val=function(a){var c,d,e,f,b=this[0];if(b&&1===b.nodeType)if(c=0===arguments.length,d=c?":get":":set",e=Mc[Kc(b)+d])f=e(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}return c?f:this},Nc={area:1,base:1,basefont:1,bgsound:1,br:1,col:1,command:1,embed:1,frame:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},Pc=s("div,ul,ol,dl,table,h1,h2,h3,h4,h5,h6,form,fieldset"),Qc=Oc("tr,style,script"),{p:Pc,select:Oc("option,optgroup,#text"),optgroup:Oc("option,#text"),option:Oc("#text"),tr:Oc("th,td,style,script"),tbody:Qc,tfoot:Qc,thead:Qc,colgroup:Oc("col"),head:Oc("base,basefont,bgsound,link,style,script,meta,title,noscript,noframes"),html:s("head,body")},Sc={xmp:1,style:1,script:1,noscript:1,textarea:1,"#comment":1,template:1},Tc={style:1,script:1,noscript:1,template:1},Uc=/\S/,Vc=/\s/,n.lexer=Wc,Xc=new h(100),bd=/^(tbody|thead|tfoot)$/,ed=/\<(\w[^\s\/\>]*)/,id=/<|&#?\w+;/,jd=new h(128),kd=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,n.parseHTML=function(a){var d,e,g,f,h,b=W();if("string"!=typeof a)return b;if(!id.test(a))return c.createTextNode(a);if(a=a.replace(kd,"<$1></$2>").trim(),d=jd.get(a))return n.cloneNode(d);for(e=Wc(a),f=0;g=e[f++];)h=n.vdom(g,"toDOM"),b.appendChild(h);return a.length<1024&&jd.put(a,b),b},n.innerHTML=function(a,b){var c=n.parseHTML(b);this.clearHTML(a),a.appendChild(c)},n.unescapeHTML=function(a){return String(a).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},n.clearHTML=function(a){for(;a.lastChild;)a.removeChild(a.lastChild);return a},ld={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0},md=n.modern&&c.ontouchstart,n.fn.bind=function(a,b,c){return this[0]?n.bind(this[0],a,b,c):void 0},n.fn.unbind=function(){if(this[0]){var d=J.call(arguments);d.unshift(this[0]),n.unbind.apply(0,d)}return this},n.bind=function(a,b,c){var d,e,f,g,h,i;return 1===a.nodeType?(d=a.getAttribute("avalon-events")||"",e=P(c),f=S[b],"click"===b&&md&&a.addEventListener("click",n.noop),f&&(b=f.type||b,f.fix&&(c=f.fix(a,c),c.uuid=e)),g=b+":"+e,n.eventListeners[c.uuid]=c,-1===d.indexOf(b+":")&&(ld[b]||n.modern&&sd[b]?td(b):n._nativeBind(a,b,rd)),h=d.split(","),""===h[0]&&h.shift(),-1===h.indexOf(g)&&(h.push(g),nd(a,h.join(","))),c):(i=function(b){c.call(a,new vd(b))},n._nativeBind(a,b,i),i)},n.unbind=function(a,b,c){var d,e;if(1===a.nodeType)switch(d=a.getAttribute("avalon-events")||"",arguments.length){case 1:n._nativeUnBind(a,b,rd),a.removeAttribute("avalon-events");break;case 2:d=d.split(",").filter(function(a){return-1===a.indexOf(b+":")}).join(","),nd(a,d);break;default:e=b+":"+c.uuid,d=d.split(",").filter(function(a){return a!==e}).join(","),nd(a,d),delete n.eventListeners[c.uuid]}else n._nativeUnBind(a,b,c)},od={},qd=/^e/,sd={focus:!0,blur:!0},ud={webkitMovementY:1,webkitMovementX:1,keyLocation:1,fixEvent:function(){},preventDefault:function(){var a=this.originalEvent||{};a.returnValue=this.returnValue=!1,g&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent||{};a.cancelBubble=this.cancelBubble=!0,g&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.stopPropagation(),this.stopImmediate=!0},toString:function(){return"[object Event]"}},vd.prototype=ud,"onmouseenter"in d||n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){S[a]={type:b,fix:function(b,c){return function(d){var e=d.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete d.type,d.type=a,c.apply(this,arguments))}}}}),n.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(a,b){m[a]&&!S.animationend&&(S.animationend={type:b})}),"onmousewheel"in c||(wd=void 0!==c.onwheel?"wheel":"DOMMouseScroll",xd="wheel"===wd?"deltaY":"detail",S.mousewheel={type:wd,fix:function(a,b){return function(c){var d=c[xd]>0?-120:120;return c.wheelDelta=~~a._ms_wheel_+d,a._ms_wheel_=c.wheelDeltaY=c.wheelDelta,c.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(c,"type",{value:"mousewheel"}),b.apply(this,arguments)}}}),g||(delete ld.change,delete ld.select),n._nativeBind=g?function(a,b,c,d){a.addEventListener(b,c,!!d)}:function(a,b,c){a.attachEvent("on"+b,c)},n._nativeUnBind=g?function(a,b,c,d){a.removeEventListener(b,c,!!d)}:function(a,b,c){a.detachEvent("on"+b,c)},n.fireDom=function(a,b,e){if(c.createEvent){var f=c.createEvent("Events");f.initEvent(b,!0,!0,e),n.shadowCopy(f,e),a.dispatchEvent(f)}else if(d.contains(a)){f=c.createEventObject(),e&&n.shadowCopy(f,e);try{a.fireEvent("on"+b,f)}catch(g){n.log("fireDom",b,"args error")}}},yd=/^(?:mouse|contextmenu|drag)|click/,vd.prototype.fixEvent=function(){var b,d,a=this;null==a.which&&0===a.type.indexOf("key")&&(a.which=null!=a.charCode?a.charCode:a.keyCode),!yd.test(a.type)||"pageX"in a||(b=a.target.ownerDocument||c,d="BackCompat"===b.compatMode?b.body:b.documentElement,a.pageX=a.clientX+(d.scrollLeft>>0)-(d.clientLeft>>0),a.pageY=a.clientY+(d.scrollTop>>0)-(d.clientTop>>0),a.wheelDeltaY=~~a.wheelDelta,a.wheelDeltaX=0)},"oninput"in c.createElement("input")||(S.input={type:"propertychange",fix:function(a,b){return function(a){return"value"===a.propertyName?(a.type="input",b.apply(this,arguments)):void 0}}}),zd=[],n.ready=function(a){zd.push(a),n.isReady&&Ad()},n.ready(function(){n.scan&&n.scan(c.body)}),b&&Bd(),Cd={script:1,style:1,textarea:1,xmp:1,noscript:1,template:1},Ed=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,Id=/input|textarea|select/i,Kd.prototype={constructor:Kd,toDOM:function(){if(this.dom)return this.dom;var a=n._decode(this.nodeValue);return this.dom=c.createTextNode(a)},toHTML:function(){return this.nodeValue}},Ld.prototype={constructor:Ld,toDOM:function(){return this.dom?this.dom:this.dom=c.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},Md.prototype={constructor:Md,toDOM:function(){var a,b,d,e,g,h,i;if(this.dom)return this.dom;b=this.nodeName,a=n.modern&&Rd[b]?Qd(b):n.modern||!Ud[b]&&!Sd.test(b)?c.createElement(b):Td(b),d=this.props||{};for(e in d)g=d[e],Od(g)&&(Pd[e]&&n.msie<8?Pd[e](a,g):a.setAttribute(e,g+""));switch(h=this.children||[],i=h[0]?h[0].nodeValue:"",this.nodeName){case"script":a.type="noexec",a.text=i;try{a.innerHTML=i}catch(j){}a.type=d.type||"";break;case"noscript":a.textContent=i;case"style":case"xmp":case"template":try{a.innerHTML=i}catch(j){Nd(a,this.nodeName,i)}break;case"option":9>f&&(a.text=i);default:!this.isVoidTag&&this.children&&this.children.forEach(function(){return h&&a.appendChild(n.vdom(h,"toDOM"))})}return this.dom=a},toHTML:function(){var c,d,e,a=[],b=this.props||{};for(c in b)d=b[c],Od(d)&&a.push(c+"="+n.quote(b[c]+""));return a=a.length?" "+a.join(" "):"",e="<"+this.nodeName+a,this.isVoidTag?e+"/>":(e+=">",this.children&&(e+=this.children.map(function(a){return a?n.vdom(a,"toHTML"):""}).join("")),e+"</"+this.nodeName+">")}},Pd={"class":function(a,b){a.className=b},style:function(a,b){a.style.cssText=b},type:function(a,b){try{a.type=b}catch(c){}},"for":function(a,b){a.setAttribute("for",b),a.htmlFor=b}},Rd=n.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),Sd=/^\w+\:\w+/,Ud=n.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath"),Vd.prototype={constructor:Vd,toDOM:function(){if(this.dom)return this.dom;var a=this.toFragment();return this.split=a.lastChild,this.dom=a},dispose:function(){this.toFragment(),this.innerRender&&this.innerRender.dispose();
for(var a in this)this[a]=null},toFragment:function(){var a=W();return this.children.forEach(function(b){return a.appendChild(n.vdom(b,"toDOM"))}),a},toHTML:function(){var a=this.children;return a.map(function(a){return n.vdom(a,"toHTML")}).join("")}},n.mix(n,{VText:Kd,VComment:Ld,VElement:Md,VFragment:Vd}),Wd={"#text":"VText","#document-fragment":"VFragment","#comment":"VComment"},n.vdomAdaptor=n.vdom=function(a,b){var c,d;return a?(c=a.nodeName)?(d=Wd[c]||"VElement",n[d].prototype[b].call(a)):new n.VFragment(a)[b]():"toHTML"===b?"":W()},n.domize=function(a){return n.vdom(a,"toDOM")},n.pendingActions=[],n.uniqActions={},n.inTransaction=0,Z.trackDeps=!1,n.track=function(){Z.trackDeps&&n.log.apply(n,arguments)},_d=[],n.transaction=ce,fe=0,ge={map:{}},he=/\?\?\d+/g,me=n.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments"),ne=n.mix({Math:1,Date:1,$event:1,window:1,__vmodel__:1,avalon:1},me),oe=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,pe=/\s*(\.|\|)\s*/g,qe=/\|\|/g,re=/\(([^)]*)\)/,se=/\|(?=\?\?)/,te=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,ue=/\.[\w\.\$]+/g,ve=/(\{|\,)\s*([\$\w]+)\s*:/g,we=/\|(\w+)/g,xe=/[$a-zA-Z_][$a-zA-Z0-9_]*/g,ye=new h(300),Be=/^__vmodel__\.[$\w\.]+$/,Ce=/__vmodel__\.([^(]+)\(([^)]*)\)/,Ge=1,He.prototype={getValue:function(){var a=this.vm;try{return this.getter.call(a,a)}catch(b){n.log(this.getter+" exec error")}},setValue:function(a){var b=this.vm;this.setter&&this.setter.call(b,b,a)},get:function(){"action track "+this.type,this.deep&&(n.deepCollect=!0);var c=ae(this,this.getValue);return this.deep&&n.deepCollect&&(n.deepCollect=!1),c},beforeUpdate:function(){return this.oldValue=Ie(this.value)},update:function(a){var c=this.beforeUpdate(),d=this.value=this.get(),e=this.callback;e&&this.diff(d,c,a)&&e.call(this.vm,this.value,c,this.expr),this._isScheduled=!1},schedule:function(){this._isScheduled||(this._isScheduled=!0,n.uniqActions[this.uuid]||(n.uniqActions[this.uuid]=1,n.pendingActions.push(this)),Yd())},removeDepends:function(){var a=this;this.observers.forEach(function(b){n.Array.remove(b.observers,a)})},diff:function(a,b){return a!==b},dispose:function(){this.value=null,this.removeDepends(),this.beforeDispose&&this.beforeDispose();for(var a in this)delete this[a]}},Je={vm:1,callback:1,observers:1,oldValue:1,value:1,getValue:1,setValue:1,get:1,removeDepends:1,beforeUpdate:1,update:1,dispose:1},Ke=1,Le.prototype={get:function(){var a,b;if(n.trackingAction&&(this.collect(),a=this.value,a&&a.$events))if(Array.isArray(a))a.forEach(function(a){a&&a.$events&&a.$events.__dep__.collect()});else if(n.deepCollect)for(b in a)a.hasOwnProperty(b)&&a[b];return this.value},collect:function(){n.track(name,"被收集"),$d(this)},updateVersion:function(){this.version=Math.random()+Math.random()},notify:function(){de(),Zd(this),ee()},set:function(a){var c,d,b=this.value;a!==b&&(n.isObject(a)&&(c=b&&b.$hashcode,d=r.createProxy(a,this),d&&(c&&(d.$hashcode=c),a=d)),this.value=a,this.updateVersion(),this.notify())}},Ne=/(\?|if\b|\(.+\))/,Qe=function(a){function b(b,c,d){a.call(this,b,void 0,d),delete c.get,delete c.set,n.mix(this,c),this.deps={},this.type="computed",this.depsVersion={},this.isComputed=!0,this.trackAndCompute(),"isStable"in this||(this.isStable=!Ne.test(Me(this.getter)))}Pe(b,a);var c=b.prototype;return c.trackAndCompute=function(){this.isStable&&this.depsCount>0?this.getValue():ae(this,this.getValue.bind(this))},c.getValue=function(){return this.value=this.getter.call(this.vm)},c.schedule=function(){for(var c,a=this.observers,b=a.length;b--;)c=a[b],c.schedule&&c.schedule()},c.shouldCompute=function(){var a,b;if(this.isStable){a=!1;for(b in this.deps)this.deps[b].version!==this.depsVersion[b]&&(a=!0,this.depsVersion[b]=this.deps[b].version);return a}return!0},c.set=function(){this.setter&&n.transaction(this.setter,this.vm,arguments)},c.get=function(){return this.collect(),this.shouldCompute()&&(this.trackAndCompute(),this.updateVersion()),this.value},b}(Le),n.define=function(a){var c,b=a.$id;return b||n.error("vm.$id must be specified"),n.vmodels[b]&&n.warn("error:["+b+"] had defined!"),c=r.modelFactory(a),n.vmodels[b]=c},r.modelFactory=function(a,b){var d,e,f,g,h,i,j,c=a.$computed||{};delete a.$computed,d=new Re(a,b),e=d.$accessors,f=[],r.hideProperty(d,"$mutations",{});for(g in a)g in Qb||(h=a[g],f.push(g),Te(g,h)&&(e[g]=Ve(g,h)));for(i in c)i in Qb||(h=c[i],"function"==typeof h&&(h={get:h}),h&&h.get&&(h.getter=h.get,h.setter=h.set,n.Array.ensure(f,i),e[i]=Ve(i,h,!0)));return j=r.createViewModel(d,e,d),r.afterCreate(j,d,f,!b),j},Se={},r.createProxy=Ue,r.itemFactory=function(a,b){var g,h,i,j,c=a.$model,d=new Re(c),e=n.shadowCopy(d.$accessors,a.$accessors),f=b.data;for(g in f)h=c[g]=d[g]=f[g],e[g]=Ve(g,h);return i=Object.keys(c),j=r.createViewModel(d,e,d),r.afterCreate(j,d,i),j},r.fuseFactory=function(a,b){var c=n.mix(a.$model,b.$model),d=new Re(n.mix(c,{$id:a.$id+b.$id})),e=n.mix(d.$accessors,a.$accessors,b.$accessors),f=Object.keys(c),g=r.createViewModel(d,e,d);return r.afterCreate(g,d,f,!1),g},Xe={get:function(){return We(this)},set:n.noop,enumerable:!1,configurable:!0},r.toJson=We,r.modelAccessor=Xe,Ye=x.splice,Ze={set:function(a,b){if(a>>>0===a&&this[a]!==b){if(a>this.length)throw Error(a+"set方法的第一个参数不能大于原数组长度");this.splice(a,1,b)}},toJSON:function(){return this.$model=r.toJson(this)},contains:function(a){return-1!==this.indexOf(a)},ensure:function(a){return this.contains(a)?!1:(this.push(a),!0)},pushArray:function(a){return this.push.apply(this,a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>>>0===a?this.splice(a,1):[]},clear:function(){return this.removeAll(),this},removeAll:function(a){var c,d;if(this.length,c=Array.isArray(a)?function(b){return-1!==a.indexOf(b)}:"function"==typeof a?a:!1)for(d=this.length-1;d>=0;d--)c(this[d],d)&&Ye.call(this,d,1);else Ye.call(this,0,this.length);this.toJSON(),this.$events.__dep__.notify()}},_e=["push","pop","shift","unshift","splice","sort","reverse"],_e.forEach(function(a){var b=x[a];Ze[a]=function(){var c=this.$events,d=r.listFactory(arguments,!0,c.__dep__),e=b.apply(this,d);return this.toJSON(),c.__dep__.notify(a),e}}),r.listFactory=af,bf=!0;try{Object.defineProperty({},"_",{value:"x"}),delete Qb.$vbsetter,delete Qb.$vbthis}catch(gb){bf=!1}cf={$vbthis:1,$vbsetter:1},r.hideProperty=df,r.fireFactory=ff,r.watchFactory=ef,r.afterCreate=hf,jf=Object.defineProperties,lf=new Date-0,bf||("__defineGetter__"in n&&(kf=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},jf=function(a,b){for(var c in b)b.hasOwnProperty(c)&&kf(a,c,b[c]);return a}),9>f&&(mf={},window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),nf=function(a,b,c,d){var e=b[c];return 4!==arguments.length?e.get.call(a):(e.set.call(a,d),void 0)},jf=function(a,b,c){var e,f,g,h,d=[];d.push("	Private [$vbsetter]","	Public  [$accessors]","	Public Default Function [$vbthis](ac"+lf+", s"+lf+")","		Set  [$accessors] = ac"+lf+": set [$vbsetter] = s"+lf,"		Set  [$vbthis]    = Me","	End Function"),e={$vbthis:!0,$vbsetter:!0,$accessors:!0};for(a in Qb)e[a]||(d.push("	Public ["+a+"]"),e[a]=!0);for(a in b)e[a]||(e[a]=!0,d.push("	Public Property Let ["+a+"](val"+lf+")",'		Call [$vbsetter](Me, [$accessors], "'+a+'", val'+lf+")","	End Property","	Public Property Set ["+a+"](val"+lf+")",'		Call [$vbsetter](Me, [$accessors], "'+a+'", val'+lf+")","	End Property","	Public Property Get ["+a+"]","	On Error Resume Next","		Set["+a+'] = [$vbsetter](Me, [$accessors],"'+a+'")',"	If Err.Number <> 0 Then","		["+a+'] = [$vbsetter](Me, [$accessors],"'+a+'")',"	End If","	On Error Goto 0","	End Property"));for(a in c)e[a]||(e[a]=!0,d.push("	Public ["+a+"]"));return d.push("	Public [hasOwnProperty]"),d.push("End Class"),f=d.join("\r\n"),g=mf[f],g||(g=n.makeHashCode("VBClass"),window.parseVB("Class "+g+f),window.parseVB(["Function "+g+"Factory(acc, vbm)","	Dim o","	Set o = (New "+g+")(acc, vbm)","	Set "+g+"Factory = o","End Function"].join("\r\n")),mf[f]=g),h=window[g+"Factory"](b,nf)})),r.createViewModel=jf,of=n.directive("important",{priority:1,getScope:function(a){var c=n.vmodels[a];if(c)return c;throw"error! no vmodel called "+a},update:function(a,b,c){var d,e;n.inBrowser&&(d=n.vdom(a,"toDOM"),1===d.nodeType&&(d.removeAttribute(b),n(d).removeClass("ms-controller")),e=n.vmodels[c],e&&(e.$element=d,e.$render=this,e.$fire("onReady"),delete e.$events.onReady))}}),pf=of.update,n.directive("controller",{priority:2,getScope:function(a,b){var c=n.vmodels[a];return c?(c.$render=this,b&&b!==c?r.fuseFactory(b,c):c):b},update:pf}),n.directive("skip",{delay:!0}),qf={},rf=n.directive("css",{diff:function(a,b){var c,d,e,g,h,i;if(Object(a)===a){if(a=r.toJson(a),Array.isArray(a)&&(c={},a.forEach(function(a){a&&n.shadowCopy(c,a)}),a=c,qf[this.type]||(n.warn("ms-"+this.type+"指令的值不建议使用数组形式了！"),qf[this.type]=1)),d=!1,e={},b){if(this.deep){"number"==typeof this.deep?this.deep:6;for(g in a){if(!uf(a[g],b[g],4))return this.value=a,!0;e[g]=a[g]}}else for(h in a)a[h]!==b[h]&&(d=!0),e[h]=a[h];for(i in b)i in e||(d=!0,e[i]="")}else e=a,d=!0;if(d)return this.value=e,!0}return!1},update:function(a,b){var d,e,c=a.dom;if(c&&1===c.nodeType){d=n(c);for(e in b)d.css(e,b[e])}}}),sf=rf.diff,xf={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},yf=void 0,zf=void 0,Af=void 0,Bf=void 0,Cf=void 0,Df=void 0,Ef=!1,Ff=!1;for(Bf in xf){if(m[Bf]){zf=xf[Bf];break}try{document.createEvent(Bf),zf=xf[Bf];break}catch(gb){}}"string"==typeof zf&&(Ef=yf=!0,Df=zf),xf={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(Bf in xf)if(m[Bf]){Af=xf[Bf];break}"string"==typeof Af&&(Ff=yf=!0,Cf=Af),Hf=n.directive("effect",{priority:5,diff:function(a){var c,d,b=this.node;return"string"==typeof a&&(this.value=a={is:a},n.warn("ms-effect的指令值不再支持字符串,必须是一个对象")),this.value=b.effect=a,c=sf.call(this,a,this.oldValue),d=this,c?(setTimeout(function(){b.animating=!0,Hf.update.call(d,b,b.effect)}),b.animating=!1,!0):!1},update:function(a,b,c){var e,f,g,h,i,j,d=a.dom;return d&&1===d.nodeType?(e=b||c,f=e.is,(g=n.effects[f])?(h={},i=Lf[e.action],"function"!=typeof Pf.prototype[i]?(n.warn("action is undefined"),void 0):(j=new n.Effect(d),n.mix(h,g,e,{action:i}),h.queue?(Mf.push(function(){j[i](h)}),Nf()):j[i](h),!0)):(n.warn(f+" effect is undefined"),void 0)):void 0}}),If="move",Jf="leave",Kf="enter",Lf={"true":Kf,"false":Jf,enter:Kf,leave:Jf,move:If,undefined:Kf},Mf=[],n.effects={},n.effect=function(a,b){var c=n.effects[a]=b||{};return yf&&c.css!==!1&&(Of(c,"enterClass",a+"-enter"),Of(c,"enterActiveClass",c.enterClass+"-active"),Of(c,"leaveClass",a+"-leave"),Of(c,"leaveActiveClass",c.leaveClass+"-active")),c},Pf=function(a){this.dom=a},n.Effect=Pf,Pf.prototype={enter:Sf("Enter"),leave:Sf("Leave"),move:Sf("Move")},Rf=new h(128),n.applyEffect=function(a,b,c){var f,g,d=c.cb,e=b.effect;e&&a&&1===a.nodeType?(f=c.hook,g=e[f],d&&(Array.isArray(g)?g.push(d):e[f]=g?[g,d]:[d]),Tf(c),n.directives.effect.update(b,e,n.shadowCopy({},c))):d&&d(a)},Vf=n.cssName("transition-duration"),Wf=n.cssName("animation-duration"),Xf=/\d+s$/,$f="none",n.parseDisplay=_f,n.directive("visible",{diff:function(a,b){var c=!!a;return void 0===b||c!==b?(this.value=c,!0):void 0},ready:!0,update:function(a,b){var d,e,f,c=a.dom;c&&1===c.nodeType&&(d=c.style.display,b?(d===$f&&(e=a.displayValue,e||(c.style.display="",""===c.style.cssText&&c.removeAttribute("style"))),""===c.style.display&&n(c).css("display")===$f&&n.contains(c.ownerDocument,c)&&(e=_f(c))):d!==$f&&(e=$f,a.displayValue=d),f=function(){void 0!==e&&(c.style.display=e)},n.applyEffect(c,a,{hook:b?"onEnterDone":"onLeaveDone",cb:f}))}}),n.directive("text",{delay:!0,init:function(){var c,d,e,f,a=this.node;a.isVoidTag&&n.error("自闭合元素不能使用ms-text"),c={nodeName:"#text",nodeValue:this.getValue()},a.children.splice(0,a.children.length,c),b&&(n.clearHTML(a.dom),a.dom.appendChild(n.vdom(c,"toDOM"))),this.node=c,d="expr",this.type=this.name=d,e=n.directives[d],f=this,this.callback=function(a){e.update.call(f,f.node,a)}}}),n.directive("expr",{update:function(a,b){b=null==b||""===b?"​":b,a.nodeValue=b,a.dom&&(a.dom.data=b)}}),n.directive("attr",{diff:sf,update:function(a,b){var d,e,c=a.props;for(d in b)!!b[d]==!1?delete c[d]:c[d]=b[d];e=a.dom,e&&1===e.nodeType&&uc(e,b)}}),n.directive("html",{update:function(a,b){this.beforeDispose(),this.innerRender=n.scan('<div class="ms-html-container">'+b+"</div>",this.vm,function(){var b=this.root;a.children&&(a.children.length=0),a.children=b.children,this.root=a,a.dom&&n.clearHTML(a.dom)})},beforeDispose:function(){this.innerRender&&this.innerRender.dispose()},delay:!0}),n.directive("if",{delay:!0,priority:5,init:function(){this.placeholder=_("if");var a=this.node.props;delete a["ms-if"],delete a[":if"],this.fragment=n.vdom(this.node,"toHTML")},diff:function(a,b){var c=!!a;return void 0===b||c!==b?(this.value=c,!0):void 0},update:function(a,b){var c,d,e;return void 0===this.isShow&&b?(ag(this,a),void 0):(this.isShow=b,c=this.placeholder,b?(d=c.parentNode,ag(this,a),d&&d.replaceChild(a.dom,c)):(this.beforeDispose(),a.nodeValue="if",a.nodeName="#comment",delete a.children,e=a.dom,d=e&&e.parentNode,a.dom=c,d&&d.replaceChild(c,e)),void 0)},beforeDispose:function(){this.innerRender&&this.innerRender.dispose()}}),n.directive("on",{beforeInit:function(){this.getter=n.noop},init:function(){var e,f,g,h,i,a=this.node,b=this.name.replace("ms-on-","e").replace("-","_"),c=b+"_"+this.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(a){return a.charCodeAt(0)}),d=n.eventListeners[c];d||(e=Ae(this.expr),f=e[0],g=e[1],f=De(f),g&&(g=g.replace(/__value__/g,"$event"),g+="\nif($event.$return){\n	return;\n}"),h=["try{","	var __vmodel__ = this;","	"+g,"	return "+f,'}catch(e){avalon.log(e, "in on dir")}'].filter(function(a){return/\S/.test(a)}),d=new Function("$event",h.join("\n")),d.uuid=c,n.eventListeners[c]=d),i=n.vdom(a,"toDOM"),i._ms_context_=this.vm,this.eventType=this.param.replace(/\-(\d)$/,""),delete this.param,n(i).bind(this.eventType,d)},beforeDispose:function(){n(this.node.dom).unbind(this.eventType)}}),fg={input:function(a){var c,d,e,f,b=this;a=a||"value",c=b.dom,d=c[a],e=b.parseValue(d),b.value=d,b.setValue(e),gg(b),f=b.pos,c.caret&&b.setCaret(c,f)},radio:function(){var b,a=this;a.isChecked?(b=!a.value,a.setValue(b),gg(a)):(fg.input.call(a),a.value=0/0)},checkbox:function(){var c,d,a=this,b=a.value;Array.isArray(b)||(n.warn("ms-duplex应用于checkbox上要对应一个数组"),b=[b]),c=a.dom.checked?"ensure":"remove",b[c]&&(d=a.parseValue(a.dom.value),b[c](d),gg(a)),this.__test__=b},select:function(){var a=this,b=n(a.dom).val();b+""!=this.value+""&&(b=Array.isArray(b)?b.map(function(b){return a.parseValue(b)}):a.parseValue(b),a.setValue(b),gg(a))},contenteditable:function(){fg.input.call(this,"innerHTML")}},ig=/\|\s*change\b/,jg=/\|\s*debounce(?:\(([^)]+)\))?/,og=!0;try{pg={},qg=HTMLInputElement.prototype,rg=HTMLTextAreaElement.prototype,sg=function(a){pg[this.tagName].call(this,a);var b=this._ms_duplex_;!this.caret&&b&&b.isString&&b.duplexCb.call(this,{type:"setter"})},tg=HTMLInputElement.prototype,Object.getOwnPropertyNames(tg),pg["INPUT"]=Object.getOwnPropertyDescriptor(qg,"value").set,Object.defineProperty(qg,"value",{set:sg}),pg["TEXTAREA"]=Object.getOwnPropertyDescriptor(rg,"value").set,Object.defineProperty(rg,"value",{set:sg}),og=!1}catch(gb){}return vg={input:function(){var a=this.node,b=this.value+"";a.dom.value=a.props.value=b},updateChecked:function(a,b){a.dom&&(a.dom.defaultChecked=a.dom.checked=b)},radio:function(){var c,a=this.node,b=a.props.value;c=this.isChecked?!!this.value:this.value+""===b,a.props.checked=c,vg.updateChecked(a,c)},checkbox:function(){var a=this.node,b=a.props,c=b.value+"",d=[].concat(this.value),e=d.some(function(a){return a+""===c});b.defaultChecked=b.checked=e,vg.updateChecked(a,e)},select:function(){var a=Array.isArray(this.value)?this.value.map(String):this.value+"";bg(this.node,a)},contenteditable:function(){var d,c,e,f,a=Wc(this.value),b=W();for(c=0;d=a[c++];)e=n.vdom(d,"toDOM"),b.appendChild(e);n.clearHTML(this.dom).appendChild(b),f=this.node.children,f.length=0,Array.prototype.push.apply(f,a),this.duplexCb.call(this.dom)}},wg=/\s+as\s+([$\w]+)/,xg=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,yg=/^(null|undefined|NaN|window|this|\$index|\$id)$/,zg=/[$\w_]+/g,n.directive("for",{delay:!0,priority:3,beforeInit:function(){var b,c,d,a=this.expr;a=a.replace(wg,function(a,c){return!xg.test(c)||yg.test(c)?n.error("alias "+c+" is invalid --- must be a valid JS identifier which is not a reserved name."):b=c,""}),c=a.split(" in "),d=c[0].match(zg),1===d.length&&d.unshift("$key"),this.expr=c[1],this.keyName=d[0],this.valName=d[1],this.signature=n.makeHashCode("for"),b&&(this.asName=b),delete this.param},init:function(){var b,c,a=this.userCb;"string"==typeof a&&a&&(b=Ae(a,"for"),c=De(b[0]),this.userCb=new Function("$event","var __vmodel__ = this\nreturn "+c)),this.node.forDir=this,this.fragment=["<div>",this.fragment,"<!--",this.signature,"--></div>"].join(""),this.cache={}},diff:function(a){if(!this.updating){this.updating=!0;var c=Bg(this,a);return void 0===this.oldTrackIds?!0:this.oldTrackIds!==c?(this.oldTrackIds=c,!0):void 0}},update:function(){if(this.preFragments?(Dg(this),Fg(this)):(this.fragments=this.fragments||[],Cg(this)),this.userCb){var a=this;setTimeout(function(){a.userCb.call(a.vm,{type:"rendered",target:a.begin.dom,signature:a.signature})},0)}delete this.updating},beforeDispose:function(){this.fragments.forEach(function(a){a.dispose()})}}),n.directive("class",{diff:function(a,b){var f,c=this.type,d=this.node,e=d.classEvent||{};return"hover"===c?(e.mouseenter=Mg,e.mouseleave=Ng):"active"===c&&(e.tabIndex=d.props.tabindex||-1,e.mousedown=Mg,e.mouseup=Ng,e.mouseleave=Ng),d.classEvent=e,f=Kg(a),void 0===typeof b||b!==f?(this.value=f,d["change-"+c]=f,!0):void 0},update:function(a,b){var d,e,f,g,h,c=a.dom;if(c&&1==c.nodeType){if(d=this.type,e="change-"+d,f=a.classEvent){for(g in f)"tabIndex"===g?c[g]=f[g]:n.bind(c,g,f[g]);a.classEvent={}}h=["class","hover","active"],h.forEach(function(a){var f,g;d===a&&("class"===a?c&&Og(c,b):(f=c.getAttribute(e),f&&n(c).removeClass(f),g="change-"+a,c.setAttribute(g,b)))})}}}),j.active=j.hover=j["class"],Lg={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"},N(Mg),N(Ng),P(Sg),P(Tg),P(Ug),P(Vg),P(hg),P(Qg),P(Rg),P(Wg),Xg=function(a){setTimeout(a,0)},n.directive("duplex",{priority:9999999,beforeInit:kg,init:lg,diff:mg,update:function(a){this.dom||ng.call(this,a,Pg),$g.call(this,n.msie,og),vg[this.dtype].call(this)}}),n.__pollValue=$g,n.msie<8&&(_g=vg.updateChecked,vg.updateChecked=function(a,b){var c=a.dom;c&&setTimeout(function(){_g(a,b),c.firstCheckedIt=1},c.firstCheckedIt?31:16)}),n.directive("rules",{diff:function(a){if(D(a)){var b=this.node;return b.rules=r.toJson(a),!0}}}),bh=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,ch=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,n.shadowCopy(n.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(a,b,c){var f,d=b.dom,e=b.data;return ah(e.pattern)||(f=d.getAttribute("pattern"),e.pattern=new RegExp("^(?:"+f+")$")),c(e.pattern.test(a)),a}},digits:{message:"必须整数",get:function(a,b,c){return c(/^\-?\d+$/.test(a)),a}},number:{message:"必须数字",get:function(a,b,c){return c(!!a&&isFinite(a)),a}},norequired:{message:"",get:function(a,b,c){return c(!0),a}},required:{message:"必须填写",get:function(a,b,c){return c(""!==a),a}},equalto:{message:"密码输入不一致",get:function(a,b,c){var d=String(b.data.equalto),e=n(document.getElementById(d)).val()||"";return c(a===e),a}},date:{message:"日期格式不正确",get:function(a,b,c){var d=b.data;return ah(d.date)?c(d.date.test(a)):c(dh(a)),a}},url:{message:"URL格式不正确",get:function(a,b,c){return c(ch.test(a)),a}},email:{message:"email格式不正确",get:function(a,b,c){return c(bh.test(a)),a}},minlength:{message:"最少输入{{minlength}}个字",get:function(a,b,c){var d=parseInt(b.data.minlength,10);return c(a.length>=d),a}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(a,b,c){var d=parseInt(b.data.maxlength,10);return c(a.length<=d),a}},min:{message:"输入值不能小于{{min}}",get:function(a,b,c){var d=parseInt(b.data.min,10);return c(parseFloat(a)>=d),a}},max:{message:"输入值不能大于{{max}}",get:function(a,b,c){var d=parseInt(b.data.max,10);return c(parseFloat(a)<=d),a}},chs:{message:"必须是中文字符",get:function(a,b,c){return c(/^[\u4e00-\u9fa5]+$/.test(a)),a}}}),eh=n.directive("validate",{diff:function(a){var c,b=this.node;if(!b.validator&&D(a)){b.validator=a,a=r.toJson(a),a.vdom=b,a.dom=b.dom;for(c in eh.defaults)a.hasOwnProperty(c)||(a[c]=eh.defaults[c]);return a.fields=a.fields||[],b.vmValidator=a,!0}},update:function(a){function f(){var a=this;a&&eh.validateAll.call(a,a.onValidateAll)}var e,g,b=a.vmValidator,c=a.validator,d=a.dom;d._ms_validate_=b,hh(a.children,b.fields,b),e=window.netscape?"keypress":"focusin",n.bind(document,e,ih);try{g=b.onManual=f.bind(b),c.onManual=g}catch(h){n.warn("要想使用onManual方法，必须在validate对象预定义一个空的onManual函数")}delete a.vmValidator,d.setAttribute("novalidate","novalidate"),b.validateAllInSubmit&&n.bind(d,"submit",gh)},validateAll:function(a){var e,f,g,b=this,c=this.vdom,d=b.fields=[];return hh(c.children,d,b),e="function"==typeof a?a:b.onValidateAll,f=b.fields.filter(function(a){var c=a.dom;return c&&!c.disabled&&b.dom.contains(c)}).map(function(a){return eh.validate(a,!0)}),g={},Promise.all(f).then(function(a){var d=a.concat.apply([],a);b.deduplicateInValidateAll&&(d=d.filter(function(a){var b=a.element,c=b.uniqueID||(b.uniqueID=setTimeout("1"));return g[c]?!1:g[c]=!0})),e.call(c.dom,d)})},validate:function(a,b,c){var g,h,i,j,k,l,m,o,d=[],e=a.value,f=a.dom;if("function"!=typeof Promise&&n.warn("浏览器不支持原生Promise,请下载并<script src=url>引入\nhttps://github.com/RubyLouvre/avalon/blob/master/test/promise.js"),!f.disabled){if(g=a.vdom.rules,h=[],i=!0,!g.norequired||""!==e)for(j in g)k=g[j],k!==!1&&(l=n.validators[j],d.push(new Promise(function(a){m=a})),o=function(b){var c={element:f,data:a.data,message:f.getAttribute("data-"+j+"-message")||f.getAttribute("data-message")||l.message,validateRule:j,getMessage:mh};b?m(!0):(i=!1,h.push(c),m(!1))},a.data={},a.data[j]=k,l.get(e,a,o));return Promise.all(d).then(function(){if(!b){var e=a.validator;i?e.onSuccess.call(f,[{data:a.data,element:f}],c):e.onError.call(f,h,c),e.onComplete.call(f,h,c)}return h})}}}),lh=/\\?{{([^{}]+)\}}/gm,eh.defaults={validate:eh.validate,onError:n.noop,onSuccess:n.noop,onComplete:n.noop,onManual:n.noop,onReset:n.noop,onValidateAll:n.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1},oh=n.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit","on"),rh=/[+-\?]/,sh=/__value__\)$/,zh={"#text":1,"#comment":1,script:1,style:1,noscript:1},n.scan=function(a,b,c){return new Ah(a,b,c||n.noop)},Ah.prototype={init:function(){var a;if(this.root&&this.root.nodeType>0)a=Gd(this.root),wh(this.root);else{if("string"!=typeof this.root)return n.warn("avalon.scan first argument must element or HTML string");a=Wc(this.root)}this.root=a[0],this.vnodes=a,this.scanChildren(a,this.vm,!0)},scanChildren:function(a,b,c){var d,e;for(d=0;d<a.length;d++)switch(e=a[d],e.nodeName){case"#text":b&&this.scanText(e,b);break;case"#comment":b&&this.scanComment(e,b,a);break;case"#document-fragment":this.scanChildren(e.children,b,!1);break;default:this.scanTag(e,b,a,!1)}c&&this.complete()},scanText:function(a,b){Z.rexpr.test(a.nodeValue)&&this.bindings.push([a,b,{nodeValue:a.nodeValue}])},scanComment:function(a,b,c){yh(a.nodeValue,"ms-for:")&&this.getForBinding(a,b,c)},scanTag:function(a,c,d,e){var h,i,k,m,o,p,q,r,s,t,u,v,w,x,y,z,f={},g=a.props;for(k in g)m=g[k],o=k,":"===k.charAt(0)&&(k="ms-"+k.slice(1)),yh(k,"ms-")&&(f[k]=m,p=k.match(/\w+/g)[1],p=oh[p]||p,j[p]||n.warn(k+" has not registered!"),h=!0),"ms-for"===k&&(i=m,delete g[o]);if(q=f["ms-important"]||f["ms-controller"]){if(r=n.serverTemplates,s=r&&r[q]){n.log("前端再次渲染后端传过来的模板"),t=Wc(s)[0];for(u in t)a[u]=t[u];return delete r[q],this.scanTag(a,c,d,e),void 0}if(p=f["ms-important"]===q?"important":"controller",v="ms-"+p in g?"ms-"+p:":"+p,b&&delete g[v],w=j[p],c=w.getScope.call(this,q,c),!c)return;x=g["class"],x&&(g["class"]=(" "+x+" ").replace(" ms-controller ","").trim()),y=this,c.$render=y,this.callbacks.push(function(){w.update.call(y,a,v,q)})}return i?(a.dom&&a.dom.removeAttribute(o),this.getForBindingByElement(a,c,d,i)):(/^ms\-/.test(a.nodeName)&&(g.is=a.nodeName),g["is"]&&(f["ms-widget"]||(f["ms-widget"]="{}"),h=!0),h&&this.bindings.push([a,c,f]),z=a.children,!Cd[a.nodeName]&&z&&z.length&&!l(f)&&this.scanChildren(z,c,!1),void 0)},complete:function(){var a,c,d;for(this.yieldDirectives(),this.beforeReady(),b&&(a=this.root,b&&(c=n.vdom(a,"toDOM"),vh(c,a.children))),this.mount=!0;d=this.callbacks.pop();)d();this.optimizeDirectives()},yieldDirectives:function(){for(var a,c,d,e,f,h,g,i,k;a=this.bindings.shift();){c=a[0],d=a[1],e=a[2],f=[],"nodeValue"in e?f=th(e):"ms-skip"in e||(f=ph(e,a));for(g=0;h=f[g++];)i=j[h.type],(b||!/on|duplex|active|hover/.test(h.type))&&(i.beforeInit&&i.beforeInit.call(h),k=new nh(d,h,c,this),this.directives.push(k))}},optimizeDirectives:function(){for(var b,a=0;b=this.directives[a++];)b.callback=j[b.type].update,b.update=Ch,b._isScheduled=!1},update:function(){for(var b,a=0;b=this.directives[a++];)b.update()},dispose:function(){var c,b,d,a=this.directives||[];for(b=0;c=a[b++];)c.dispose();for(d in this)"dispose"!==d&&delete this[d]},getForBinding:function(a,b,c,d){var f,g,h,e=a.nodeValue.replace("ms-for:","").trim();a.nodeValue="ms-for:"+e,f=xh(c,a),g=f.end,h=n.vdom(f,"toHTML"),c.splice(f.start,f.length),a.props={},this.bindings.push([a,b,{"ms-for":e},{begin:a,end:g,expr:e,userCb:d,fragment:h,parentChildren:c}])},getForBindingByElement:function(a,b,c,d){var h,e=c.indexOf(a),f=a.props,g={nodeName:"#comment",nodeValue:"ms-for:"+d};f.slot&&(g.slot=f.slot,delete f.slot),h={nodeName:"#comment",nodeValue:"ms-for-end:"},c.splice(e,1,g,a,h),this.getForBinding(g,b,c,f["data-for-rendered"])}},Dh="onInit,onReady,onViewChange,onDispose,onEnter,onLeave",Eh=n.oneObject(Dh),Gh=[],n.directive("widget",{delay:!0,priority:4,deep:!0,init:function(){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,a=this.node;if(this.cacheVm=!!a.props.cached,a.dom&&"#comment"===a.nodeName&&(b=a.dom),c=this.getValue(),d=Fh(c),e=a.props.is||d.is,this.is=e,f=n.components[e],"fragment"in this||(a.isVoidTag?this.fragment=!1:(g=a.children[0],this.fragment=g&&g.nodeValue?g.nodeValue:n.vdom(a.children,"toHTML"))),!f)return this.readyState=0,a.nodeName="#comment",a.nodeValue="unresolved component placeholder",delete a.dom,n.Array.ensure(Gh,this),void 0;if(h=d.id||d.$id,i=n.vmodels[h],j=!1,i)k=i,this.comVm=k,Hh(this,k.$render),j=!0;else{if("function"==typeof f&&(f=new f(d)),k=Jh(f,d,e),this.readyState=1,Ih(k,a,"Init"),this.comVm=k,l=n.scan(f.template,k),k.$render=l,Hh(this,l),m=[],o=[],this.fragment||f.soleSlot){p=this.fragment?this.vm:k,q=this.fragment||"{{##"+f.soleSlot+"}}",r=n.scan("<div>"+q+"</div>",p,function(){m=this.root.children}),o=r.directives,this.childBoss=r;for(s in r)delete r[s]}Array.prototype.push.apply(l.directives,o),t=[],u={},f.soleSlot?t=m:m.forEach(function(a){var c,d;a.slot?(c=xh(m,a),c.push(c.end),c.unshift(a),u[a.slot]=c):a.props&&(d=a.props.slot,d&&(delete a.props.slot,Array.isArray(u[d])?u[d].push(a):u[d]=[a]))}),f.soleSlot?Mh(l.vnodes,t):Nh(l.vnodes,u)}b&&(v=n.vdom(a,"toDOM"),b.parentNode.replaceChild(v,b),k.$element=l.root.dom=v,delete this.reInit),wh(a.dom),k.$element=a.dom,vh(a.dom,a.children),j?Ih(k,a,"Enter"):Ih(k,a,"Ready")},diff:function(a,b){return sf.call(this,a,b)?!0:void 0},update:function(a,b){switch(this.readyState){case 0:this.reInit&&(this.init(),this.readyState++);break;case 1:this.readyState++;break;default:this.readyState++;var c=this.comVm;n.viewChanging=!0,n.transaction(function(){for(var a in b)c.hasOwnProperty(a)&&(c[a]=Array.isArray(b[a])?b[a].concat():b[a])}),Ih(c,a,"ViewChange"),delete n.viewChanging}this.value=n.mix(!0,{},b)},beforeDispose:function(){var a=this.comVm;this.cacheVm?Ih(a,this.node,"Leave"):(Ih(a,this.node,"Dispose"),a.$hashcode=!1,delete n.vmodels[a.$id],this.innerRender&&this.innerRender.dispose())}}),n.components={},n.component=function(a,b){return b.extend=Ph,Oh(a,b)},n});